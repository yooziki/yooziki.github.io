<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/favicon.png" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.min.css">
  <script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yooziki.github.io","root":"/","scheme":"Gemini","version":"8.0.0-rc.4","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#ff8fa4","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true},"motion":{"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Lua是什么  Lua是一种轻量小巧的脚本语言，用标准C语言编写并以源代码形式开放，其设计目的是为了嵌入应用程序中，从而为应用程序提供灵活的扩展和定制功能 Lua可以很方便的和其它程序进行集成">
<meta property="og:type" content="article">
<meta property="og:title" content="Lua编程">
<meta property="og:url" content="https://yooziki.github.io/2021/04/042615/index.html">
<meta property="og:site_name" content="CYoo柚子小站">
<meta property="og:description" content="Lua是什么  Lua是一种轻量小巧的脚本语言，用标准C语言编写并以源代码形式开放，其设计目的是为了嵌入应用程序中，从而为应用程序提供灵活的扩展和定制功能 Lua可以很方便的和其它程序进行集成">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-04-03T16:24:17.000Z">
<meta property="article:modified_time" content="2021-04-07T03:30:30.712Z">
<meta property="article:author" content="YOOZIKI">
<meta property="article:tag" content="Lua入门">
<meta property="article:tag" content="Lua">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://yooziki.github.io/2021/04/042615/">


<script data-pjax id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>
<style>
    .pace .pace-progress {
        background: #ff0000; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #ff0000, 0 0 5px     #ff0000; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #ff0000;    /*上边框颜色*/
        border-left-color: #ff0000;    /*左边框颜色*/
    }
</style>
  <title>Lua编程 | CYoo柚子小站</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line toggle-line-first"></span>
        <span class="toggle-line toggle-line-middle"></span>
        <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">CYoo柚子小站</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">57</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">18</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">44</span></a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404.html" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a>

  </li>
        <li class="menu-item menu-item-coffee">

    <a href="/coffee" rel="section"><i class="fas fa-coffee fa-fw"></i>咖啡</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#lua是什么"><span class="nav-number">1.</span> <span class="nav-text"> Lua是什么</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#lua与c的区别"><span class="nav-number">2.</span> <span class="nav-text"> Lua与C#的区别</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#lua环境安装"><span class="nav-number">3.</span> <span class="nav-text"> Lua环境安装</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#scite"><span class="nav-number">3.1.</span> <span class="nav-text"> SciTE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#luadist"><span class="nav-number">3.2.</span> <span class="nav-text"> LuaDist</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#语法"><span class="nav-number">4.</span> <span class="nav-text"> 语法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#print方法-单行和多行注释"><span class="nav-number">4.1.</span> <span class="nav-text"> print方法、单行和多行注释</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#标识符"><span class="nav-number">4.2.</span> <span class="nav-text"> 标识符</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#保留字"><span class="nav-number">4.2.1.</span> <span class="nav-text"> 保留字</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#全局变量和局部变量"><span class="nav-number">4.3.</span> <span class="nav-text"> 全局变量和局部变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#多变量同时赋值"><span class="nav-number">4.4.</span> <span class="nav-text"> 多变量同时赋值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据类型"><span class="nav-number">4.5.</span> <span class="nav-text"> 数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#nil空"><span class="nav-number">4.5.1.</span> <span class="nav-text"> nil（空）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#boolean布尔"><span class="nav-number">4.5.2.</span> <span class="nav-text"> boolean(布尔)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#number数字"><span class="nav-number">4.5.3.</span> <span class="nav-text"> number（数字）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#string字符串"><span class="nav-number">4.5.4.</span> <span class="nav-text"> string（字符串）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#转义字符"><span class="nav-number">4.5.4.1.</span> <span class="nav-text"> 转义字符</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#string操作"><span class="nav-number">4.5.4.2.</span> <span class="nav-text"> string操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#table表"><span class="nav-number">4.5.5.</span> <span class="nav-text"> table（表）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#初始化-查看-修改"><span class="nav-number">4.5.5.1.</span> <span class="nav-text"> 初始化、查看、修改</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#table操作"><span class="nav-number">4.5.5.2.</span> <span class="nav-text"> table操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#array数组"><span class="nav-number">4.5.5.3.</span> <span class="nav-text"> Array（数组）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#metatable元表"><span class="nav-number">4.5.5.4.</span> <span class="nav-text"> metatable（元表）</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#metatable操作"><span class="nav-number">4.5.5.4.1.</span> <span class="nav-text"> metatable操作</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#setmetatabletable-metatable"><span class="nav-number">4.5.5.4.1.1.</span> <span class="nav-text"> setmetatable(table, metatable)</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#getmetatabletable"><span class="nav-number">4.5.5.4.1.2.</span> <span class="nav-text"> getmetatable(table)</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#__metatable元方法"><span class="nav-number">4.5.5.4.1.3.</span> <span class="nav-text"> __metatable元方法</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#__index元方法"><span class="nav-number">4.5.5.4.1.4.</span> <span class="nav-text"> __index元方法</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#__newindex元方法"><span class="nav-number">4.5.5.4.1.5.</span> <span class="nav-text"> __newindex元方法</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#操作符"><span class="nav-number">4.5.5.4.1.6.</span> <span class="nav-text"> 操作符</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#__call元方法"><span class="nav-number">4.5.5.4.1.7.</span> <span class="nav-text"> __call元方法</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#function函数"><span class="nav-number">4.5.6.</span> <span class="nav-text"> function（函数）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#可变参数"><span class="nav-number">4.5.6.1.</span> <span class="nav-text"> 可变参数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#thread线程"><span class="nav-number">4.5.7.</span> <span class="nav-text"> thread（线程）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#userdata自定义类型"><span class="nav-number">4.5.8.</span> <span class="nav-text"> userdata（自定义类型）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#循环"><span class="nav-number">4.6.</span> <span class="nav-text"> 循环</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#while"><span class="nav-number">4.6.1.</span> <span class="nav-text"> while</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#for"><span class="nav-number">4.6.2.</span> <span class="nav-text"> for</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#repeatuntil"><span class="nav-number">4.6.3.</span> <span class="nav-text"> repeat…until</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#iterator-迭代器"><span class="nav-number">4.7.</span> <span class="nav-text"> iterator 迭代器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义迭代器"><span class="nav-number">4.7.1.</span> <span class="nav-text"> 自定义迭代器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#流程控制逻辑判断"><span class="nav-number">4.8.</span> <span class="nav-text"> 流程控制(逻辑判断)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#运算符"><span class="nav-number">4.9.</span> <span class="nav-text"> 运算符</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#数学运算符"><span class="nav-number">4.9.1.</span> <span class="nav-text"> 数学运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关系运算符"><span class="nav-number">4.9.2.</span> <span class="nav-text"> 关系运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#逻辑运算符"><span class="nav-number">4.9.3.</span> <span class="nav-text"> 逻辑运算符</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#模块"><span class="nav-number">5.</span> <span class="nav-text"> 模块</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#定义module"><span class="nav-number">5.1.</span> <span class="nav-text"> 定义module</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用module"><span class="nav-number">5.2.</span> <span class="nav-text"> 使用module</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#c包"><span class="nav-number">6.</span> <span class="nav-text"> C包</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#协同程序coroutine"><span class="nav-number">7.</span> <span class="nav-text"> 协同程序（coroutine）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#定义和启动协同函数"><span class="nav-number">7.1.</span> <span class="nav-text"> 定义和启动协同函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#方法1"><span class="nav-number">7.1.1.</span> <span class="nav-text"> 方法1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方法2"><span class="nav-number">7.1.2.</span> <span class="nav-text"> 方法2</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#暂停-继续和返回值"><span class="nav-number">7.2.</span> <span class="nav-text"> 暂停、继续和返回值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查看协同程序状态"><span class="nav-number">7.3.</span> <span class="nav-text"> 查看协同程序状态</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#协程复制"><span class="nav-number">7.4.</span> <span class="nav-text"> 协程复制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查看当前运行协程的协程号"><span class="nav-number">7.5.</span> <span class="nav-text"> 查看当前运行协程的协程号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#案例"><span class="nav-number">7.6.</span> <span class="nav-text"> 案例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#文件读写io"><span class="nav-number">8.</span> <span class="nav-text"> 文件读写（I&#x2F;O）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#对于mode"><span class="nav-number">8.1.</span> <span class="nav-text"> 对于mode</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#简单模式文件读写-simple-model"><span class="nav-number">8.2.</span> <span class="nav-text"> 简单模式文件读写 simple model</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ioreadarg"><span class="nav-number">8.2.1.</span> <span class="nav-text"> io.read(arg)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#iotmpfile"><span class="nav-number">8.2.2.</span> <span class="nav-text"> io.tmpfile()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#iotypefile"><span class="nav-number">8.2.3.</span> <span class="nav-text"> io.type(file)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ioflush"><span class="nav-number">8.2.4.</span> <span class="nav-text"> io.flush()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#iolinesoptional-file-name"><span class="nav-number">8.2.5.</span> <span class="nav-text"> io.lines(optional file name)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#完全模式文件读写-complete-model"><span class="nav-number">8.3.</span> <span class="nav-text"> 完全模式文件读写 complete model</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#错误处理"><span class="nav-number">9.</span> <span class="nav-text"> 错误处理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#错误处理-2"><span class="nav-number">9.1.</span> <span class="nav-text"> 错误处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#调试debug"><span class="nav-number">9.2.</span> <span class="nav-text"> 调试（debug）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#垃圾回收机制"><span class="nav-number">9.3.</span> <span class="nav-text"> 垃圾回收机制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#垃圾回收器函数"><span class="nav-number">9.3.1.</span> <span class="nav-text"> 垃圾回收器函数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#面向对象"><span class="nav-number">10.</span> <span class="nav-text"> 面向对象</span></a></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="YOOZIKI"
      src="/images/img/head.JPG">
  <p class="site-author-name" itemprop="name">YOOZIKI</p>
  <div class="site-description" itemprop="description">分享 学习 记录</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">44</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">57</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/yooziki" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yooziki" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:775086089@QQ.com" title="E-Mail → mailto:775086089@QQ.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/37478964" title="Bilibili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;37478964" rel="noopener" target="_blank"><i class="fas fa-tv fa-fw"></i>Bilibili</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



    <div class="links-of-blogroll motion-element links-of-blogroll-block">
      <div class="links-of-blogroll-title">
        <!-- modify icon to fire by szw -->
        <i class="fa fa-history fa-" aria-hidden="true"></i>
        近期文章
      </div>
      <ul class="links-of-blogroll-list">
        
        
        
          <li>
            <a href="/2021/04/0838463/" title="CSharp编程" target="_blank">CSharp编程</a>
          </li>
        
          <li>
            <a href="/2021/04/0741816/" title="xLua热更新" target="_blank">xLua热更新</a>
          </li>
        
          <li>
            <a href="/2021/04/0743832/" title="AssetBundle打包" target="_blank">AssetBundle打包</a>
          </li>
        
          <li>
            <a href="/2021/04/042615/" title="Lua编程" target="_blank">Lua编程</a>
          </li>
        
          <li>
            <a href="/2021/04/0313789/" title="Json入门" target="_blank">Json入门</a>
          </li>
        
      </ul>
    </div>

      </section>
	  
	  <section class="site-overview-wrap sidebar-panel">
		<div style="">
  <canvas id="canvas" style="width:60%;">当前浏览器不支持canvas，请更换浏览器后再试</canvas>
</div>
<script>
(function(){

   var digit=
    [
        [
            [0,0,1,1,1,0,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,0,1,1,0],
            [0,0,1,1,1,0,0]
        ],//0
        [
            [0,0,0,1,1,0,0],
            [0,1,1,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [1,1,1,1,1,1,1]
        ],//1
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,1,1],
            [1,1,1,1,1,1,1]
        ],//2
        [
            [1,1,1,1,1,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//3
        [
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,0],
            [0,0,1,1,1,1,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,1,1,0],
            [1,1,1,1,1,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,1]
        ],//4
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,1,1,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//5
        [
            [0,0,0,0,1,1,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//6
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0]
        ],//7
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//8
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,1,1,0,0,0,0]
        ],//9
        [
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0]
        ]//:
    ];

var canvas = document.getElementById('canvas');

if(canvas.getContext){
    var cxt = canvas.getContext('2d');
    //声明canvas的宽高
    var H = 100,W = 700;
    canvas.height = H;
    canvas.width = W;
    cxt.fillStyle = '#f00';
    cxt.fillRect(10,10,50,50);

    //存储时间数据
    var data = [];
    //存储运动的小球
    var balls = [];
    //设置粒子半径
    var R = canvas.height/20-1;
    (function(){
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        //存储时间数字，由十位小时、个位小时、冒号、十位分钟、个位分钟、冒号、十位秒钟、个位秒钟这7个数字组成
        data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
    })();

    /*生成点阵数字*/
    function renderDigit(index,num){
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    cxt.beginPath();
                    cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);
                    cxt.closePath();
                    cxt.fill();
                }
            }
        }
    }

    /*更新时钟*/
    function updateDigitTime(){
        var changeNumArray = [];
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        var NewData = [];
        NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
        for(var i = data.length-1; i >=0 ; i--){
            //时间发生变化
            if(NewData[i] !== data[i]){
                //将变化的数字值和在data数组中的索引存储在changeNumArray数组中
                changeNumArray.push(i+'_'+(Number(data[i])+1)%10);
            }
        }
        //增加小球
        for(var i = 0; i< changeNumArray.length; i++){
            addBalls.apply(this,changeNumArray[i].split('_'));
        }
        data = NewData.concat();
    }

    /*更新小球状态*/
    function updateBalls(){
        for(var i = 0; i < balls.length; i++){
            balls[i].stepY += balls[i].disY;
            balls[i].x += balls[i].stepX;
            balls[i].y += balls[i].stepY;
            if(balls[i].x > W + R || balls[i].y > H + R){
                balls.splice(i,1);
                i--;
            }
        }
    }

    /*增加要运动的小球*/
    function addBalls(index,num){
        var numArray = [1,2,3];
        var colorArray =  ["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"];
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    var ball = {
                        x:14*(R+2)*index + j*2*(R+1)+(R+1),
                        y:i*2*(R+1)+(R+1),
                        stepX:Math.floor(Math.random() * 4 -2),
                        stepY:-2*numArray[Math.floor(Math.random()*numArray.length)],
                        color:colorArray[Math.floor(Math.random()*colorArray.length)],
                        disY:1
                    };
                    balls.push(ball);
                }
            }
        }
    }

    /*渲染*/
    function render(){
        //重置画布宽度，达到清空画布的效果
        canvas.height = 100;
        //渲染时钟
        for(var i = 0; i < data.length; i++){
            renderDigit(i,data[i]);
        }
        //渲染小球
        for(var i = 0; i < balls.length; i++){
            cxt.beginPath();
            cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);
            cxt.fillStyle = balls[i].color;
            cxt.closePath();
            cxt.fill();
        }
    }

    clearInterval(oTimer);
    var oTimer = setInterval(function(){
        //更新时钟
        updateDigitTime();
        //更新小球状态
        updateBalls();
        //渲染
        render();
    },50);
}

})();
</script>
	  </section>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </header>

      
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/yooziki" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


      <div class="main-inner">
        

        <div class="content post posts-expand">
          

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yooziki.github.io/2021/04/042615/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/img/head.JPG">
      <meta itemprop="name" content="YOOZIKI">
      <meta itemprop="description" content="分享 学习 记录">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CYoo柚子小站">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Lua编程
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-04 00:24:17" itemprop="dateCreated datePublished" datetime="2021-04-04T00:24:17+08:00">2021-04-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-04-07 11:30:30" itemprop="dateModified" datetime="2021-04-07T11:30:30+08:00">2021-04-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%AD%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">语法</span></a>
                </span>
            </span>

          
            <span id="/2021/04/042615/" class="post-meta-item leancloud_visitors" data-flag-title="Lua编程" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/04/042615/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/04/042615/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>26k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>24 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="lua是什么"><a class="markdownIt-Anchor" href="#lua是什么"></a> Lua是什么</h1>
<hr>
<p>Lua是一种轻量小巧的脚本语言，用标准C语言编写并以源代码形式开放，其设计目的是为了嵌入应用程序中，从而为应用程序提供灵活的扩展和定制功能</p>
<p>Lua可以很方便的和其它程序进行集成</p>
<a id="more"></a>
<h1 id="lua与c的区别"><a class="markdownIt-Anchor" href="#lua与c的区别"></a> Lua与C#的区别</h1>
<hr>
<ul>
<li>Lua</li>
</ul>
<p>可以在几乎所有的操作系统和平台进行编译运行</p>
<p>可以很方便的更新代码</p>
<p>更新了代码后，可以直接在手机上运行，不需要重新安装（热更新）</p>
<ul>
<li>C#</li>
</ul>
<p>C#只能在特定的操作系统中进行编译成dll文件，然后打包进安装包在其它平台运行。</p>
<p>在移动平台上不能更新替换已有的dll文件，除非重新下载安装包</p>
<h1 id="lua环境安装"><a class="markdownIt-Anchor" href="#lua环境安装"></a> Lua环境安装</h1>
<hr>
<h2 id="scite"><a class="markdownIt-Anchor" href="#scite"></a> SciTE</h2>
<hr>
<p>Windows 系统上安装Lua</p>
<p>可以使用一个叫SciTE的IDE环境来执行Lua程序，下载地址为：</p>
<ul>
<li><a href="https://github.com/rjpcomputing/luaforwindows/releases/">Github</a></li>
<li><a href="https://code.google.com/p/luaforwindows/downloads/list">Google Code</a></li>
</ul>
<p>下载并安装<code>LuaForWindows_vx.x.x-xx.exe</code>，完成后获得控制台lua.exe以及编辑器SciTE.exe</p>
<h2 id="luadist"><a class="markdownIt-Anchor" href="#luadist"></a> <a href="http://luadist.org/">LuaDist</a></h2>
<hr>
<p>可以在各种平台运行</p>
<h1 id="语法"><a class="markdownIt-Anchor" href="#语法"></a> 语法</h1>
<hr>
<h2 id="print方法-单行和多行注释"><a class="markdownIt-Anchor" href="#print方法-单行和多行注释"></a> print方法、单行和多行注释</h2>
<hr>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">"hello world"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"hello yooziki"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"可以输出"</span>,<span class="string">"多个值"</span>,<span class="string">"利用逗号分隔"</span>)</span><br><span class="line"><span class="comment">-- print用来向控制台输出字符</span></span><br><span class="line"><span class="comment">--[=[</span></span><br><span class="line"><span class="comment">这是</span></span><br><span class="line"><span class="comment">一个</span></span><br><span class="line"><span class="comment">多行</span></span><br><span class="line"><span class="comment">注释</span></span><br><span class="line"><span class="comment">--]=]</span></span><br><span class="line"><span class="comment">---[[可以转义多行注释头</span></span><br></pre></td></tr></table></figure></div>
<h2 id="标识符"><a class="markdownIt-Anchor" href="#标识符"></a> 标识符</h2>
<hr>
<ul>
<li>开头：A-Z、a-z、下划线</li>
<li>后面加上0个或多个字母、下划线、数字</li>
<li>最好不要使用下划线加大写字母，可能会与Lua的保留字冲突，如：<code>_NAME</code></li>
<li>Lua不允许特殊字符</li>
<li>Lua区分大小写</li>
</ul>
<h3 id="保留字"><a class="markdownIt-Anchor" href="#保留字"></a> 保留字</h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>and</td>
<td>break</td>
<td>do</td>
<td>else</td>
</tr>
<tr>
<td>elseif</td>
<td>end</td>
<td>false</td>
<td>for</td>
</tr>
<tr>
<td>function</td>
<td>if</td>
<td>in</td>
<td>local</td>
</tr>
<tr>
<td>nil</td>
<td>not</td>
<td>or</td>
<td>repeat</td>
</tr>
<tr>
<td>return</td>
<td>then</td>
<td>true</td>
<td>until</td>
</tr>
<tr>
<td>while</td>
<td>goto</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<blockquote>
<p>nil意味着空</p>
</blockquote>
<h2 id="全局变量和局部变量"><a class="markdownIt-Anchor" href="#全局变量和局部变量"></a> 全局变量和局部变量</h2>
<hr>
<p>默认情况下，变量是全局的。变量不需要声明变量类型</p>
<p>删除变量：<code>var = nil</code></p>
<p>调用优先级：最近声明的局部变量 &gt; 其他局部变量 &gt; 全局变量</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--声明变量</span></span><br><span class="line">a = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(a))</span><br><span class="line"></span><br><span class="line"><span class="comment">--变量类型可以随时变化的</span></span><br><span class="line">a = <span class="string">"hello"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(a))</span><br><span class="line"></span><br><span class="line"><span class="comment">--局部变量，生命在代码块内存在</span></span><br><span class="line"><span class="keyword">local</span> b = <span class="number">10</span></span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"before define local c, c is "</span>..<span class="built_in">type</span>(c)) <span class="comment">--c is global c,nil</span></span><br><span class="line">	c = <span class="number">5</span> <span class="comment">--define global c</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"after define local c, d is "</span>..<span class="built_in">type</span>(c)) <span class="comment">--c is number</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"before define local d, d is "</span>..<span class="built_in">type</span>(d)) <span class="comment">--d is global d,string</span></span><br><span class="line">	<span class="keyword">local</span> d = <span class="number">6</span> <span class="comment">--define local d,在函数外不存在</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"after define local d, d is "</span>..<span class="built_in">type</span>(d)) <span class="comment">--d is number</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"before define local e, e is "</span>..<span class="built_in">type</span>(e)) <span class="comment">--e is global e,nil</span></span><br><span class="line">	<span class="keyword">local</span> e = <span class="number">10</span><span class="comment">--define local e</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"after define local e, e is "</span>..<span class="built_in">type</span>(e)) <span class="comment">--e is number</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">d = <span class="string">"world"</span></span><br><span class="line">test()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"out of function, c is "</span>..<span class="built_in">type</span>(c)) <span class="comment">--c is global c ,number</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"out of function, d is "</span>..<span class="built_in">type</span>(d)) <span class="comment">--d is global d ,string</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"out of function, e is "</span>..<span class="built_in">type</span>(e)) <span class="comment">--e is global e ,nil</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--制造代码块</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="keyword">local</span> f = <span class="number">10</span></span><br><span class="line">    g = <span class="number">11</span></span><br><span class="line">    <span class="built_in">print</span>(f,g) <span class="comment">--10 11</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">print</span>(f,g) <span class="comment">--nil 11</span></span><br></pre></td></tr></table></figure></div>
<h2 id="多变量同时赋值"><a class="markdownIt-Anchor" href="#多变量同时赋值"></a> 多变量同时赋值</h2>
<hr>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">a,b = <span class="number">10</span>,<span class="number">20</span> <span class="comment">--a=10; b=20</span></span><br><span class="line">a,b,c = <span class="number">10</span>,<span class="number">20</span>,<span class="string">"hello"</span> <span class="comment">--a=10;b=20;c="hello"</span></span><br><span class="line"><span class="built_in">print</span>(a,b,c) <span class="comment">--10 20 hello</span></span><br><span class="line">a,b=b,a <span class="comment">--c=b;b=a;a=c;c=nil</span></span><br><span class="line"><span class="built_in">print</span>(a,b) <span class="comment">--20 10</span></span><br><span class="line">c=b;b=a;a=c;c=<span class="literal">nil</span></span><br><span class="line"><span class="built_in">print</span>(a,b) <span class="comment">--10 20</span></span><br><span class="line">a,b,c = <span class="literal">nil</span>,<span class="literal">nil</span>,<span class="literal">nil</span></span><br><span class="line"><span class="comment">--左右数量不对称</span></span><br><span class="line">a,b = <span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span> <span class="comment">--多出来的右值会被忽略</span></span><br><span class="line"><span class="built_in">print</span>(a,b) <span class="comment">--10 20</span></span><br><span class="line">a,b,c = <span class="number">10</span>,<span class="number">20</span> <span class="comment">--多出来的左值会以nil赋值（相当于被忽略）</span></span><br><span class="line"><span class="built_in">print</span>(a,b,c) <span class="comment">--10 20 nil</span></span><br></pre></td></tr></table></figure></div>
<h2 id="数据类型"><a class="markdownIt-Anchor" href="#数据类型"></a> 数据类型</h2>
<hr>
<table>
<thead>
<tr>
<th>描述</th>
<th>数据类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>表示无效值，相当于null</td>
<td>nil</td>
</tr>
<tr>
<td>布尔值</td>
<td>boolean</td>
</tr>
<tr>
<td>表示双精度类型的实浮点数</td>
<td>number</td>
</tr>
<tr>
<td>字符串，双引号或单引号包括</td>
<td>string</td>
</tr>
<tr>
<td>C或Lua编写的函数</td>
<td>function</td>
</tr>
<tr>
<td>任意存储在变量中的C数据结构</td>
<td>userdata</td>
</tr>
<tr>
<td>表示执行的独立线路，协程</td>
<td>thread</td>
</tr>
<tr>
<td>Lua中的表，其实是一个“关联数组”，数组的所有可以是数字或者字符串。在Lua里，table的创建是通过“构造表达式”来完成，最简单的构造表达式是<code>｛｝</code>，用来创建一个空表</td>
<td>table</td>
</tr>
</tbody>
</table>
<blockquote>
<p>可以利用type来测试数据类型，type返回的是字符串</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="string">"hello world"</span>)) <span class="comment">--string</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="number">123</span>)) <span class="comment">--number</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="literal">false</span>)) <span class="comment">--boolean</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="literal">nil</span>)) <span class="comment">-- nil</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="built_in">print</span>)) <span class="comment">--function</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(x)) <span class="comment">--nil</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(&#123;&#125;)) <span class="comment">--table</span></span><br></pre></td></tr></table></figure></div>
</blockquote>
<h3 id="nil空"><a class="markdownIt-Anchor" href="#nil空"></a> nil（空）</h3>
<hr>
<ul>
<li>对于没有定义过的变量，都是nil</li>
<li>给变量赋值nil，表示在内存中销毁此变量</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">"yooziki"</span></span><br><span class="line"><span class="built_in">print</span>(name) <span class="comment">--yooziki</span></span><br><span class="line">name = <span class="literal">nil</span></span><br><span class="line"><span class="built_in">print</span>(name) <span class="comment">--nil</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">table</span> = &#123;key1 = <span class="string">"value1"</span>, key2 = <span class="string">"value2"</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.key1) <span class="comment">--value1</span></span><br><span class="line"><span class="built_in">table</span>.key1 = <span class="literal">nil</span></span><br><span class="line"><span class="built_in">table</span> = <span class="literal">nil</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>) <span class="comment">--nil</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.key1) <span class="comment">--error</span></span><br></pre></td></tr></table></figure></div>
<h3 id="boolean布尔"><a class="markdownIt-Anchor" href="#boolean布尔"></a> boolean(布尔)</h3>
<hr>
<blockquote>
<p>nil被当做false</p>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="literal">true</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="literal">false</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="literal">nil</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"nil被当作true处理"</span>)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"nil被当作false处理"</span>) <span class="comment">--print this</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></div>
<h3 id="number数字"><a class="markdownIt-Anchor" href="#number数字"></a> number（数字）</h3>
<hr>
<p>lua只有一种number类型 ，c做的所有数字类型都被包含进去</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="number">2.2</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="number">0.2</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="number">2e+1</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="number">0.2e-11</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="number">2.852315734347351</span>))</span><br></pre></td></tr></table></figure></div>
<h3 id="string字符串"><a class="markdownIt-Anchor" href="#string字符串"></a> string（字符串）</h3>
<hr>
<p>字符串由一对双引号或单引号表示单行，用<code>[[ ]]</code>包含表示多行</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">str1 = <span class="string">"this is string1"</span></span><br><span class="line">str2 = <span class="string">"this is string2"</span></span><br><span class="line"></span><br><span class="line">str3 =</span><br><span class="line"><span class="string">[[</span></span><br><span class="line"><span class="string">this</span></span><br><span class="line"><span class="string">is</span></span><br><span class="line"><span class="string">string3</span></span><br><span class="line"><span class="string">]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--字符串只能使用..进行组拼，+只能用来做计算</span></span><br><span class="line">str4 = <span class="string">"this "</span>..<span class="string">"is "</span>..<span class="string">"string4"</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"2"</span>+<span class="string">"6"</span>) <span class="comment">--输出为8，自动eval</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"2"</span>*<span class="string">"6"</span>) <span class="comment">--输出为12</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--计算字符串长度</span></span><br><span class="line"><span class="built_in">print</span>(#str3) <span class="comment">--输出为16</span></span><br><span class="line"><span class="built_in">print</span>(#<span class="string">"你好"</span>) <span class="comment">--输出为4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">print("a" + "b") --error</span></span><br><span class="line"><span class="comment">print(2..3) --error</span></span><br><span class="line"><span class="comment">--]]</span></span><br></pre></td></tr></table></figure></div>
<h4 id="转义字符"><a class="markdownIt-Anchor" href="#转义字符"></a> 转义字符</h4>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[=[</span></span><br><span class="line"><span class="comment">\n 换行</span></span><br><span class="line"><span class="comment">\\ 单个\</span></span><br><span class="line"><span class="comment">\" 代表"</span></span><br><span class="line"><span class="comment">\' 代表'</span></span><br><span class="line"><span class="comment">\r 回车</span></span><br><span class="line"><span class="comment">--]=]</span></span><br><span class="line">a = <span class="string">"hello\nmy name is \"yooziki\"\n!\r~"</span></span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[输出</span></span><br><span class="line"><span class="comment">hello</span></span><br><span class="line"><span class="comment">my name is "yooziki"</span></span><br><span class="line"><span class="comment">!</span></span><br><span class="line"><span class="comment">!</span></span><br><span class="line"><span class="comment">]]</span></span><br></pre></td></tr></table></figure></div>
<table>
<thead>
<tr>
<th>转义字符</th>
<th>意义</th>
<th>ASCII码值（十进制）</th>
</tr>
</thead>
<tbody>
<tr>
<td>\a</td>
<td>响铃</td>
<td>007</td>
</tr>
<tr>
<td>\b</td>
<td>退格，将当前位置移到前一列</td>
<td>008</td>
</tr>
<tr>
<td>\f</td>
<td>换页，将当前位置移到下页开头</td>
<td>012</td>
</tr>
<tr>
<td>\n</td>
<td>换行，将当前位置移到下一行开头</td>
<td>010</td>
</tr>
<tr>
<td>\r</td>
<td>回车，将当前位置移到本行开头</td>
<td>013</td>
</tr>
<tr>
<td>\t</td>
<td>水平制表，调到下一个TAB位置</td>
<td>009</td>
</tr>
<tr>
<td>\v</td>
<td>垂直制表</td>
<td>011</td>
</tr>
<tr>
<td>\\</td>
<td>代表一个反斜杠\</td>
<td>092</td>
</tr>
<tr>
<td>\’</td>
<td>代表一个单引号字符</td>
<td>039</td>
</tr>
<tr>
<td>\&quot;</td>
<td>代表一个双引号字符</td>
<td>034</td>
</tr>
<tr>
<td>\0</td>
<td>空字符</td>
<td>000</td>
</tr>
<tr>
<td>\ddd</td>
<td>1到3位八进制数所代表的任意字符</td>
<td>三位八进制</td>
</tr>
<tr>
<td>\xhh</td>
<td>1到2位十六进制所代表的任意字符</td>
<td>二位十六进制</td>
</tr>
</tbody>
</table>
<h4 id="string操作"><a class="markdownIt-Anchor" href="#string操作"></a> string操作</h4>
<p>string的本质是一个table</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">str = <span class="string">"My name is Yooziki!"</span></span><br><span class="line">str2 = <span class="built_in">string</span>.<span class="built_in">upper</span>(str)</span><br><span class="line"><span class="built_in">print</span>(str2) <span class="comment">--MY NAME IS YOOZIKI!</span></span><br><span class="line">str3 = <span class="built_in">string</span>.<span class="built_in">lower</span>(str)</span><br><span class="line"><span class="built_in">print</span>(str3) <span class="comment">--my name is yooziki!</span></span><br><span class="line"></span><br><span class="line">str4 = <span class="built_in">string</span>.<span class="built_in">gsub</span>(str,<span class="string">"i"</span>,<span class="string">"2"</span>) <span class="comment">--区分大小写</span></span><br><span class="line"><span class="built_in">print</span>(str4) <span class="comment">--My name 2s Yooz2k2!</span></span><br><span class="line">str5 = <span class="built_in">string</span>.<span class="built_in">gsub</span>(str,<span class="string">"i"</span>,“<span class="number">33</span>”,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(str5) <span class="comment">--My name 2s Yooziki!</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li>
<p>string.upper(str)<br>
返回一个新的string，将所有小写字母转变为大写的</p>
</li>
<li>
<p>string.lower(str)<br>
返回一个新的string，将所有大写字母转变为小写的</p>
</li>
<li>
<p>string.gsub(str,“src”,“dst”&lt;,可替换最大次数&gt;)<br>
返回一个string，将str中所有&lt;或者前次数个&gt;src变为dst<br>
<code>str4 = string.gsub(str,&quot;i&quot;,&quot;2&quot;) --y name 2s Yooz2k2!</code><br>
<code>str5 = string.gsub(str,&quot;i&quot;,2,1) ----My name 2s Yooziki!</code></p>
</li>
<li>
<p>string.find(str,“key”&lt;,开始查找的位置&gt;)<br>
返回第一个符合key的首字母的索引位置和尾字母的索引位置<br>
<code>index1,index2 = string.find(&quot;name is is&quot;,&quot;is is&quot;) --6 10</code></p>
</li>
<li>
<p>string.reverse(str)<br>
返回一个string，将原有str中的字符反转<br>
<code>str6 = string.reverse(str) --!ikizooY si eman yM</code></p>
</li>
<li>
<p>string.format(“加法运算：%d+%d=%d”,num1,num2,(num1+num2)<br>
字符串格式化，返回一个string，是格式化之后的<br>
等同于<code>&quot;加法运算：&quot;..num1..&quot;+&quot;..num2..&quot;=&quot;..(num1+num2)</code></p>
<ul>
<li>%d ，%i - 接受一个数字，并将其转化为有符号的整数格式</li>
<li>%c - 接受一个数字，并将其转化为ASCII码表中对应的知乎</li>
<li>%o - 接受一个数字并将其转化为八进制数</li>
<li>%u - 接受一个数字并将其转化为无符号整数格式</li>
<li>%x - 接受一个数字，并将其转化为十六进制数，使用小写</li>
<li>%X - 接受一个数字，并将其转化为十六进制数，使用大写</li>
<li>%e - 接受一个数字，并将其转化为科学计数法，使用小写</li>
<li>%E - 接受一个数字，并将其转化为科学计数法，使用大写</li>
<li>%f - 接受一个数字并将其转化为浮点数格式</li>
<li>%G(%g) - 接受一个数字，并将其转化为%E(%e)、%f中较短的一个</li>
<li>%q - 接受一个字符串并将其转化为可安全被Lua编译器读入的格式</li>
<li>%s - 接受一个字符串并按照给定的参数格式化该字符串</li>
</ul>
<p>为进一步细化格式，可以在%号后添加参数，参数将以如下的顺序读入：</p>
<ol>
<li>符号：一个+号表示其后的数字转义符将让正数显示正号。默认情况下只有负数显示符号</li>
<li>占位符：一个0，在后面指定了字串宽度时占位用，不填时默认占位符是空格</li>
<li>对齐标识：在指定了字串宽度时，默认为右对齐，增加-号可以改为左对齐</li>
<li>宽度数值</li>
<li>小数位数/字串裁切：在宽度数值后增加的小数部分n，若后接f（浮点数转义符，如%6.3f）则设定该浮点数的小数只保留n位，若后接s（字符串转义符，如%5.3s）则设定该字符串只显示前n位</li>
</ol>
<p><code>print(string.format(&quot;格式化：%+0-9.4f&quot;,15)) --格式化：+15.0000</code></p>
</li>
<li>
<p>string.char(arg)<br>
将ASCII码转为字符<br>
<code>string.char(97,98,99,100) --abcd</code></p>
</li>
<li>
<p>string.byte(arg&lt;,int&gt;)<br>
将字符串中指定的字符转换为ASCII，默认第一个<br>
<code>string.byte(&quot;ABCD&quot;) --65</code><br>
<code>string.byte(&quot;ABCD&quot;,4) --68</code></p>
</li>
<li>
<p>string.len(str)<br>
计算字符串的长度</p>
</li>
<li>
<p>string.rep(str,int)<br>
返回一个string，string的内容是将str重复int次<br>
<code>string.byte(&quot;abcd&quot;,2) --abcdabcd</code></p>
</li>
<li>
<p>…<br>
字符串之间连接起来</p>
</li>
<li>
<p>string.gmatch(str,pattern)<br>
每调用一次，返回一个在字符串str找到的下一个符合pattern描述的子串，如果参数pattern描述的字符串没有找到，迭代函数返回nil<br>
（正则表达式）</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> word <span class="keyword">in</span> <span class="built_in">string</span>.<span class="built_in">gmatch</span>(<span class="string">"Hello Lua ueser"</span>,<span class="string">"%a+"</span>) <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">print</span>(word)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--Hello</span></span><br><span class="line"><span class="comment">--Lua</span></span><br><span class="line"><span class="comment">--user</span></span><br></pre></td></tr></table></figure></div>
</li>
<li>
<p>string.match(str,pattern&lt;,init&gt;)<br>
只找第一个配对的，init可以指定起始位置<br>
配对成功返回匹配的字符串结果，没有成功时候返回nil<br>
（正则表达式）</p>
</li>
</ul>
<h3 id="table表"><a class="markdownIt-Anchor" href="#table表"></a> table（表）</h3>
<hr>
<ul>
<li>
<p>不固定长度</p>
</li>
<li>
<p>利用<code>=</code>赋值时只是浅复制，置空某个表时只是更改了当前变量的指向地址，当实际的table内存不被任何变量指向的时候，自动销毁</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tab1 = &#123;&#125;</span><br><span class="line">tab2 = tab1</span><br><span class="line">tab2[<span class="number">1</span>] = <span class="string">"Lua"</span></span><br><span class="line"><span class="built_in">print</span>(tab1[<span class="number">1</span>]) <span class="comment">--Lua</span></span><br><span class="line">tab1 = <span class="literal">nil</span> <span class="comment">--tab1现在指向nil</span></span><br><span class="line"><span class="built_in">print</span>(tab2[<span class="number">1</span>])	<span class="comment">--Lua,tab2依然指向table内存块，所以内存块不被销毁</span></span><br><span class="line">tab2 = <span class="literal">nil</span> <span class="comment">--tab2指向nil，table内存块无法再被访问，自动被销毁</span></span><br></pre></td></tr></table></figure></div>
</li>
</ul>
<h4 id="初始化-查看-修改"><a class="markdownIt-Anchor" href="#初始化-查看-修改"></a> 初始化、查看、修改</h4>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">tab1 = &#123;&#125; <span class="comment">--空表</span></span><br><span class="line">tab2 = &#123;key1 = <span class="string">"100"</span>, key2 = <span class="string">"value2"</span>&#125;</span><br><span class="line">tab3 = &#123;key1 = <span class="string">"100"</span>, key2 = <span class="string">"value2"</span>,<span class="string">"value3"</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(tab1) <span class="comment">--地址</span></span><br><span class="line"><span class="built_in">print</span>(tab2) <span class="comment">--地址</span></span><br><span class="line"><span class="built_in">print</span>(tab1.key) <span class="comment">--nil</span></span><br><span class="line"><span class="built_in">print</span>(tab2.key1) <span class="comment">--100</span></span><br><span class="line"><span class="built_in">print</span>(tab2[<span class="string">"key2"</span>]) <span class="comment">--value2</span></span><br><span class="line"><span class="built_in">print</span>(tab2[<span class="number">1</span>]) <span class="comment">--nil,无效访问</span></span><br><span class="line"><span class="built_in">print</span>(tab3[<span class="number">1</span>]) <span class="comment">--value3，证明索引是按顺序分配给表中的无key值</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tab3 = &#123;<span class="string">"apple"</span>,<span class="string">"pear"</span>,<span class="string">"orange"</span>,<span class="string">"grape"</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(tab3[<span class="number">2</span>]) <span class="comment">--pear,索引编号从1开始</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--遍历</span></span><br><span class="line"><span class="keyword">for</span> key,val <span class="keyword">in</span> <span class="built_in">pairs</span>(tab3) <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">print</span>(key..<span class="string">"="</span>..val)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--修改</span></span><br><span class="line">tab1.key1 = <span class="string">"www.yooziki.site"</span> <span class="comment">--键没有类型</span></span><br><span class="line">tab1[<span class="string">"key2"</span>] = <span class="string">"yooziki"</span></span><br><span class="line"><span class="comment">--添加</span></span><br><span class="line">tab1[<span class="number">10</span>] = <span class="number">1000</span> <span class="comment">--索引可以是不连续的</span></span><br><span class="line"><span class="comment">--删除</span></span><br><span class="line">tab1[<span class="number">10</span>] = <span class="literal">nil</span></span><br><span class="line">tab3[<span class="number">3</span>] = <span class="literal">nil</span> <span class="comment">--tab3中的key还剩下 1,2,4；3被删除</span></span><br><span class="line"></span><br><span class="line">tab3 = <span class="literal">nil</span> <span class="comment">--删除整个表，释放内存</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--统计</span></span><br><span class="line">tab = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(#tab) <span class="comment">--5</span></span><br><span class="line">tab = <span class="literal">nil</span></span><br><span class="line">tab = &#123;key3 = <span class="string">"123"</span>,key4 = <span class="string">"456"</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(#tab) <span class="comment">--0，无法统计</span></span><br><span class="line">tab.key1 = <span class="number">34</span></span><br><span class="line">tab.key2 = <span class="string">"sas"</span></span><br><span class="line"><span class="built_in">print</span>(#tab) <span class="comment">--0，无法统计</span></span><br><span class="line"></span><br><span class="line">tab = <span class="literal">nil</span></span><br><span class="line">tab[<span class="number">100</span>] = <span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(#tab) <span class="comment">--100,取得table中的最大索引</span></span><br></pre></td></tr></table></figure></div>
<blockquote>
<p>table不会固定长度大小，会自动进行放缩</p>
<p>可以使用<code>#</code>对类数组类型对table进行统计，但是不能统计类字典类型或者混合类型的table</p>
<p>因为<code>#</code>是用来取得table中的最大索引，但是如果有不连贯的索引，可能会造成错误</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">tab = <span class="literal">nil</span></span><br><span class="line">tab = &#123;&#125;</span><br><span class="line">tab[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">tab[<span class="number">2</span>] = <span class="number">3</span></span><br><span class="line">tab[<span class="number">4</span>] = <span class="number">4</span></span><br><span class="line">tab[<span class="number">6</span>] = <span class="number">6</span></span><br><span class="line">tab[<span class="number">8</span>] =<span class="number">10</span></span><br><span class="line"><span class="comment">--tab[100] = 233</span></span><br><span class="line"><span class="built_in">print</span>(#tab) <span class="comment">--8</span></span><br><span class="line"></span><br><span class="line">tab = <span class="literal">nil</span></span><br><span class="line">tab = &#123;&#125;</span><br><span class="line">tab[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">tab[<span class="number">2</span>] = <span class="number">3</span></span><br><span class="line">tab[<span class="number">4</span>] = <span class="number">4</span></span><br><span class="line">tab[<span class="number">6</span>] = <span class="number">6</span></span><br><span class="line">tab[<span class="number">8</span>] =<span class="number">10</span></span><br><span class="line">tab[<span class="number">100</span>] = <span class="number">233</span></span><br><span class="line"><span class="built_in">print</span>(#tab) <span class="comment">--8</span></span><br></pre></td></tr></table></figure></div>
</blockquote>
<h4 id="table操作"><a class="markdownIt-Anchor" href="#table操作"></a> table操作</h4>
<ul>
<li>
<p>table.concat(table&lt;,str&lt;,index&lt;,index&gt;&gt;&gt;)<br>
第一个参数是需要拼接的table，第二个是拼接之间需要插入的字符串，第三四是拼接起始和结束位置的索引</p>
<blockquote>
<p>只能对数组进行操作</p>
<p>无法对多维数组进行操作</p>
<p>只能对以index作为键的数据进行组合，只能组合number、string，如果有其它类型也是以index键值对的，则会产生错误</p>
<p>index的索引编号必须是连续的，否则会产生错误</p>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">"table方法"</span>)</span><br><span class="line">tab = &#123;<span class="string">"Lua"</span>,<span class="string">"C#"</span>,<span class="string">"Java"</span>,<span class="string">"C"</span>,<span class="string">"C++"</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(tab)) <span class="comment">--LuaC#JavaCC++</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(tab,<span class="string">",,"</span>)) <span class="comment">--Lua,,C#,,Java,,C,,C++</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(tab,<span class="string">""</span>,<span class="number">2</span>)) <span class="comment">--C#JavaCC++</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(tab,<span class="string">""</span>,<span class="number">2</span>,<span class="number">4</span>)) <span class="comment">--C#JavaC</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--混合型table</span></span><br><span class="line">tab = &#123;key2 = <span class="string">"Lua"</span>,<span class="string">"C#"</span>,<span class="string">"Java"</span>,<span class="string">"C"</span>,<span class="string">"C++"</span>,key = <span class="number">3</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(tab)) <span class="comment">--C#JavaCC++</span></span><br><span class="line">tab = &#123;<span class="string">"Lua"</span>,<span class="string">"C#"</span>,<span class="string">"Java"</span>,<span class="string">"C"</span>,<span class="string">"C++"</span>,&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(tab)) <span class="comment">--运行错误</span></span><br></pre></td></tr></table></figure></div>
</li>
<li>
<p>table.insert(table&lt;,index&gt;, content)<br>
在指定索引处或者在table末尾处插入一个数据，当是在指定处插入时，插入位置后面的值自动索引+1</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--insert方法</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">"%15s"</span>,<span class="string">"insert方法"</span>))</span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">insert</span>(tab,<span class="string">"PHP"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(tab,<span class="string">" "</span>)) <span class="comment">--Lua C# Java C C++ 3 PHP</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">insert</span>(tab,<span class="number">1</span>,<span class="string">"PYTHON"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(tab,<span class="string">" "</span>)) <span class="comment">--PYTHON Lua C# Java C C++ 3 PHP</span></span><br></pre></td></tr></table></figure></div>
</li>
<li>
<p>table.remove(table&lt;,index&gt;)<br>
不填写index时默认删除最后一个，指定index删除指定位置，然后后面的键值对index自动-1，保持index连续性</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--remove方法</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">"%15s"</span>,<span class="string">"remove方法"</span>))</span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">remove</span>(tab)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(tab,<span class="string">" "</span>)) <span class="comment">--PYTHON Lua C# Java C C++ 3</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">remove</span>(tab,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(tab,<span class="string">" "</span>)) <span class="comment">--PYTHON C# Java C C++ 3</span></span><br><span class="line">tab[<span class="number">2</span>] = <span class="literal">nil</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(tab,<span class="string">" "</span>)) <span class="comment">--运行错误</span></span><br></pre></td></tr></table></figure></div>
</li>
<li>
<p>table.sort(tab)<br>
按照首字母的ASCII排序，如果相同，则看第二个字母，只能是纯字符串数组（index-值对中的值只能是string类型）或者纯number数组</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--sort方法</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">"%15s"</span>,<span class="string">"sort方法"</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(tab,<span class="string">" "</span>)) <span class="comment">--PYTHON C# Java C C++</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">sort</span>(tab)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(tab,<span class="string">" "</span>)) <span class="comment">--C C# C++ Java PYTHON</span></span><br><span class="line">tab = &#123;<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">65</span>,<span class="number">121</span>,<span class="number">34</span>,<span class="number">4141</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">120</span>&#125;</span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">sort</span>(tab)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(tab,<span class="string">" "</span>)) <span class="comment">--1 2 4 4 4 6 34 65 120 121 4141</span></span><br></pre></td></tr></table></figure></div>
</li>
</ul>
<h4 id="array数组"><a class="markdownIt-Anchor" href="#array数组"></a> Array（数组）</h4>
<p>自动编号的table，本质是table</p>
<p>自动索引的序号自1开始，可以被主动设置为任意整数，包括负数</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">array = &#123;<span class="string">"Lua"</span>,<span class="string">"C#"</span>&#125;</span><br><span class="line"><span class="keyword">for</span> i=<span class="number">0</span>,<span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">print</span>(array[i+<span class="number">1</span>])</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">array = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i = <span class="number">-2</span>,<span class="number">2</span> <span class="keyword">do</span></span><br><span class="line">	array[i] = i*<span class="number">3</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">-2</span>,<span class="number">2</span> <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">print</span>(array[i])</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--多维数组</span></span><br><span class="line">array = &#123;&#123;<span class="string">"a1"</span>,<span class="string">"a2"</span>&#125;,&#123;<span class="string">"b1"</span>,<span class="string">"b2"</span>&#125;,&#123;<span class="string">"c1"</span>,<span class="string">"c2"</span>&#125;,&#123;<span class="string">"d1"</span>,<span class="string">"d2"</span>&#125;&#125; <span class="comment">--4*2</span></span><br><span class="line"><span class="built_in">print</span>(array[<span class="number">1</span>][<span class="number">2</span>]) <span class="comment">--a2</span></span><br><span class="line"></span><br><span class="line">array = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i=<span class="number">1</span>,<span class="number">3</span> <span class="keyword">do</span></span><br><span class="line">	array[i] = &#123;&#125;</span><br><span class="line">	<span class="keyword">for</span> j=<span class="number">1</span>,<span class="number">2</span> <span class="keyword">do</span></span><br><span class="line">		array[i][j] = i*j</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i=<span class="number">1</span>,<span class="number">3</span> <span class="keyword">do</span></span><br><span class="line">	<span class="keyword">for</span> j=<span class="number">1</span>,<span class="number">2</span> <span class="keyword">do</span></span><br><span class="line">		<span class="built_in">print</span>(array[i][j])</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></div>
<h4 id="metatable元表"><a class="markdownIt-Anchor" href="#metatable元表"></a> metatable（元表）</h4>
<p>对普通table进行功能拓展</p>
<p>在元表中定义拓展功能的操作，例如：相加操作、打印表操作</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 无元表</span></span><br><span class="line">a =&#123;&#125;</span><br><span class="line">b =&#123;&#125;</span><br><span class="line">a+b <span class="comment">--无法进行</span></span><br><span class="line"><span class="built_in">print</span>(a,b) <span class="comment">--输出a,b的地址</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">10</span>]) <span class="comment">--nil,不存在的索引</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--设置元表</span></span><br><span class="line">mytable = &#123;&#125; <span class="comment">--表</span></span><br><span class="line">metatable = &#123;&#125; <span class="comment">--元表,如果存在 _metatable 键值，setmetatable会失效</span></span><br><span class="line"><span class="built_in">setmetatable</span>(mytable,metatable) <span class="comment">--把metatable设置为table的元表</span></span><br><span class="line">mytable2 = <span class="built_in">setmetatable</span>(&#123;&#125;,&#123;&#125;) <span class="comment">--也可以用这种方法设置</span></span><br></pre></td></tr></table></figure></div>
<h5 id="metatable操作"><a class="markdownIt-Anchor" href="#metatable操作"></a> metatable操作</h5>
<ul>
<li>
<h6 id="setmetatabletable-metatable"><a class="markdownIt-Anchor" href="#setmetatabletable-metatable"></a> setmetatable(table, metatable)</h6>
<p>给table设置metatable，并且返回table。<br>
<s>metatable中存在__metatable键值对的时候设置会失效</s></p>
</li>
<li>
<h6 id="getmetatabletable"><a class="markdownIt-Anchor" href="#getmetatabletable"></a> getmetatable(table)</h6>
<p>返回该table的metatable地址，如果没有则返回空值<br>
如果metatable存在__metatable键值，则返回改值</p>
</li>
<li>
<h6 id="__metatable元方法"><a class="markdownIt-Anchor" href="#__metatable元方法"></a> __metatable元方法</h6>
<p>保护元表的地址，使元表不会被用户访问到。防止对metatable的修改<br>
<code>__metatable = str</code></p>
</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--setmetatable,getmetatable</span></span><br><span class="line">metatable1 = &#123;&#125;</span><br><span class="line">tab1 = <span class="built_in">setmetatable</span>(&#123;&#125;,metatable1)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">getmetatable</span>(tab1),metatable1) <span class="comment">--table: 00C1A740	table: 00C1A740</span></span><br><span class="line">metatable1[<span class="string">"__metatable"</span>] = <span class="string">"lock"</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">getmetatable</span>(tab1),metatable1) <span class="comment">--lock	table: 00C1A740</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li>
<h6 id="__index元方法"><a class="markdownIt-Anchor" href="#__index元方法"></a> __index元方法</h6>
<p>当通过键来访问table的时候<code>tablep[key]</code>，如果__index的值是table，则会在table没有对应键值对的时候寻找__index中的键值对</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">other = &#123;foo = <span class="number">3</span>&#125;</span><br><span class="line">t = <span class="built_in">setmetatable</span>(&#123;foo = <span class="number">2</span>&#125;,&#123;<span class="built_in">__index</span> = other&#125;)</span><br><span class="line"><span class="built_in">print</span>(t.foo) <span class="comment">--2</span></span><br><span class="line">t.foo = <span class="literal">nil</span></span><br><span class="line"><span class="built_in">print</span>(t.foo) <span class="comment">--3</span></span><br><span class="line"><span class="built_in">print</span>(t.bar) <span class="comment">--nil</span></span><br></pre></td></tr></table></figure></div>
<p>当__index的值是函数的时候，如果访问table的键值对存在，则调用函数，否则返回<code>return</code>值，不设置return时候默认返回<code>nil</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mytable = &#123;<span class="string">"Lua"</span>,<span class="string">"C#"</span>,<span class="string">"C++"</span>&#125;</span><br><span class="line">metatable = &#123;</span><br><span class="line">	<span class="built_in">__index</span> = <span class="function"><span class="keyword">function</span><span class="params">(tab,key)</span></span> <span class="comment">--固定键和固定函数头</span></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">"调用了index方法"</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"不存在"</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>(mytable,metatable)</span><br><span class="line"><span class="built_in">print</span>(mytable[<span class="number">2</span>]) <span class="comment">--调用了index方法</span></span><br><span class="line"><span class="built_in">print</span>(mytable[<span class="number">10</span>]) <span class="comment">--不存在</span></span><br></pre></td></tr></table></figure></div>
</li>
<li>
<h6 id="__newindex元方法"><a class="markdownIt-Anchor" href="#__newindex元方法"></a> __newindex元方法</h6>
<p>可以指定function或table，</p>
<ul>
<li>指定为function时，当对表的数据进行新建的时候(从nil变为其它类型的时候)，会起作用。注意要在function内部给table添加设置的值，否则无法执行赋值操作<br>
<code>rawset(tab,key,value)</code><br>
利用insert方法新建键值对无法调用此元方法，因为inset内部是调用的<code>rawset</code>函数进行赋值的</li>
<li>指定为table时，新添加的数据会添加到这个table中</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">mytable = &#123;<span class="string">"Lua"</span>,<span class="string">"C#"</span>,<span class="string">"C++"</span>&#125;</span><br><span class="line">metatable = &#123;</span><br><span class="line">	<span class="built_in">__newindex</span> = <span class="function"><span class="keyword">function</span><span class="params">(tab,key,value)</span></span> <span class="comment">--固定键和固定函数头</span></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">"我们要修改的key为"</span>,key,value)</span><br><span class="line">        <span class="built_in">rawset</span>(tab,key,value)</span><br><span class="line">        <span class="comment">--tab[key,value] --会产生死循环，因为这种赋值方法会递归调用__newindex，但是没有出口</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>(mytable,metatable)</span><br><span class="line">mytable[<span class="number">3</span>] = <span class="string">"Python"</span> <span class="comment">--无</span></span><br><span class="line">mytable[<span class="number">4</span>] = <span class="string">"Java"</span> <span class="comment">--我们要修改的key为 4  Java，因为新建了一个编号为4的index</span></span><br><span class="line">mytable[<span class="number">4</span>] = <span class="literal">nil</span></span><br><span class="line">mytable[<span class="number">4</span>] = <span class="string">"Java"</span> <span class="comment">--我们要修改的key为	4	Java</span></span><br><span class="line"><span class="built_in">rawset</span>(mytable,<span class="number">5</span>,<span class="string">"JSON"</span>) <span class="comment">--无发生</span></span><br><span class="line"><span class="built_in">print</span>(mytable[<span class="number">4</span>],mytable[<span class="number">5</span>]) <span class="comment">--Java	JSON</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">insert</span>(mytable,<span class="string">"PHP"</span>) <span class="comment">--无</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--指定为table时</span></span><br><span class="line">mytable = &#123;<span class="string">"Lua"</span>,<span class="string">"C#"</span>,<span class="string">"C++"</span>&#125;</span><br><span class="line">newtable = &#123;&#125;</span><br><span class="line">metatable = &#123;</span><br><span class="line">	<span class="built_in">__newindex</span> = newtable</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>(mytable,metatable)</span><br><span class="line">mytable[<span class="number">1</span>] = <span class="string">"PHP"</span></span><br><span class="line"><span class="built_in">print</span>(mytable[<span class="number">1</span>]) <span class="comment">--PHP</span></span><br><span class="line">mytable[<span class="number">4</span>] = <span class="string">"Java"</span></span><br><span class="line"><span class="built_in">print</span>(mytable[<span class="number">4</span>],newtable[<span class="number">4</span>]) <span class="comment">--nil Java</span></span><br><span class="line"><span class="built_in">rawset</span>(mytable,<span class="number">4</span>,<span class="string">"HTML"</span>)</span><br><span class="line"><span class="built_in">print</span>(mytable[<span class="number">4</span>],newtable[<span class="number">4</span>]) <span class="comment">--HTML Java</span></span><br></pre></td></tr></table></figure></div>
</li>
<li>
<h6 id="操作符"><a class="markdownIt-Anchor" href="#操作符"></a> 操作符</h6>
<ul>
<li>
<p>加：__add<br>
指定一个function，作为table相加时候的规则<br>
一连串的运算中只需要定义一个metatable，比如<br>
<code>tab1 + tab2 + tab3</code>其中tab1有元表定义了__add，tab2和tab3没有元表，但是<code>tab3+tab2+tab1</code>会出错，故运算符会向前寻找最近一个重定向它的元表，如果找到则使用，如果没有找到会查询相邻右侧的元表，如果找到则使用，没有找到则返回运行错误</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">mytable = &#123;<span class="string">"Lua"</span>,<span class="string">"C#"</span>,<span class="string">"C++"</span>&#125;</span><br><span class="line">newtable = &#123;<span class="string">"PHP"</span>,<span class="string">"Python"</span>&#125;</span><br><span class="line">metatable = &#123;</span><br><span class="line">	<span class="built_in">__add</span> = <span class="function"><span class="keyword">function</span><span class="params">(tab,newtab)</span></span></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">"相加"</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">setmetatable</span>(mytable,metatable)</span><br><span class="line"><span class="comment">--===注意两个表的前后关系====</span></span><br><span class="line">v = mytable + newtable</span><br><span class="line"><span class="built_in">print</span>(v) <span class="comment">--nil</span></span><br><span class="line">v=newtable + mytable</span><br><span class="line"><span class="built_in">print</span>(v) <span class="comment">--nil</span></span><br><span class="line"><span class="comment">--=======================</span></span><br><span class="line">newmetatable = &#123;</span><br><span class="line">	<span class="built_in">__add</span> = <span class="function"><span class="keyword">function</span><span class="params">(tab,newtab)</span></span></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">"相加"</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">3</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">setmetatable</span>(newtable,newmetatable)</span><br><span class="line"><span class="comment">--===注意两个表的前后关系====</span></span><br><span class="line">v = mytable + newtable</span><br><span class="line"><span class="built_in">print</span>(v) <span class="comment">--nil</span></span><br><span class="line">v=newtable + mytable</span><br><span class="line"><span class="built_in">print</span>(v) <span class="comment">--3</span></span><br><span class="line"><span class="comment">--=======================</span></span><br><span class="line"></span><br><span class="line">mytable = &#123;<span class="string">"Lua"</span>,<span class="string">"C#"</span>,<span class="string">"C++"</span>&#125;</span><br><span class="line">newtable = &#123;<span class="string">"PHP"</span>,<span class="string">"Python"</span>&#125;</span><br><span class="line">metatable = &#123;</span><br><span class="line">	<span class="built_in">__add</span> = <span class="function"><span class="keyword">function</span><span class="params">(tab,newtab)</span></span></span><br><span class="line">		<span class="keyword">local</span> t = <span class="number">0</span></span><br><span class="line">		<span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">pairs</span>(tab) <span class="keyword">do</span></span><br><span class="line">			<span class="keyword">if</span>(k&gt;t) <span class="keyword">then</span></span><br><span class="line">				t = k</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">pairs</span>(newtab) <span class="keyword">do</span></span><br><span class="line">			t = t + <span class="number">1</span></span><br><span class="line">			<span class="built_in">table</span>.<span class="built_in">insert</span>(tab,t,v)</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">return</span> tab</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">setmetatable</span>(mytable,metatable)</span><br><span class="line">v = mytable + newtable</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(v,<span class="string">" "</span>)) <span class="comment">--Lua C# C++ PHP Python</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(mytable,<span class="string">" "</span>)) <span class="comment">--Lua C# C++ PHP Python</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(newtable,<span class="string">" "</span>)) <span class="comment">--PHP Python</span></span><br><span class="line">v=newtable + mytable</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(v,<span class="string">" "</span>)) <span class="comment">--PHP Python Lua C# C++ PHP Python</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(mytable,<span class="string">" "</span>)) <span class="comment">--Lua C# C++ PHP Python</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(newtable,<span class="string">" "</span>)) <span class="comment">--PHP Python Lua C# C++ PHP Python</span></span><br></pre></td></tr></table></figure></div>
</li>
<li>
<p>__sub操作符<br>
同理，对应<code>-</code></p>
</li>
<li>
<p>__mul操作符<br>
对应<code>*</code></p>
</li>
<li>
<p>__div操作符<br>
对应<code>/</code></p>
</li>
<li>
<p>__mod操作符<br>
对应<code>%</code></p>
</li>
<li>
<p>__unm操作符<br>
对应取负值的<code>-</code></p>
</li>
<li>
<p>__concat操作符<br>
对应字符串连接的<code>..</code></p>
</li>
<li>
<p>__eq操作符<br>
对应<code>==</code></p>
</li>
<li>
<p>__lt<br>
对应<code>&lt;</code></p>
</li>
<li>
<p>__le<br>
对应<code>&gt;</code></p>
</li>
</ul>
</li>
<li>
<h6 id="__call元方法"><a class="markdownIt-Anchor" href="#__call元方法"></a> __call元方法</h6>
<p>把表当作函数进行调用</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">"%25s"</span>,<span class="string">"__call元方法"</span>))</span><br><span class="line">mytable = &#123;<span class="string">"Lua"</span>,<span class="string">"C#"</span>,<span class="string">"C++"</span>&#125;</span><br><span class="line">metatable = &#123;</span><br><span class="line">	<span class="built_in">__call</span> = <span class="function"><span class="keyword">function</span><span class="params">(tab,arg)</span></span></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">"被当作函数传入的参数是"</span>,<span class="built_in">arg</span>)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">setmetatable</span>(mytable,metatable)</span><br><span class="line"></span><br><span class="line">mytable(<span class="string">"yooziki"</span>) <span class="comment">--被当作函数传入的参数是	yooziki</span></span><br></pre></td></tr></table></figure></div>
</li>
<li>
<p>__tostring元方法<br>
更改<code>print(table)</code>打印的内容</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mytable = &#123;<span class="string">"Lua"</span>,<span class="string">"C#"</span>,<span class="string">"C++"</span>&#125;</span><br><span class="line">metatable = &#123;</span><br><span class="line">	<span class="built_in">__tostring</span> = <span class="function"><span class="keyword">function</span><span class="params">(tab)</span></span></span><br><span class="line">		<span class="keyword">local</span> str = <span class="string">""</span></span><br><span class="line">		<span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">pairs</span>(tab) <span class="keyword">do</span></span><br><span class="line">			str = str..k..<span class="string">" "</span>..v..<span class="string">", \n"</span></span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">return</span> str</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">setmetatable</span>(mytable,metatable)</span><br><span class="line"><span class="built_in">print</span>(mytable)</span><br><span class="line">&gt;&gt;<span class="number">1</span> Lua, </span><br><span class="line">&gt;&gt;<span class="number">2</span> C#, </span><br><span class="line">&gt;&gt;<span class="number">3</span> C++,</span><br></pre></td></tr></table></figure></div>
</li>
</ul>
<h3 id="function函数"><a class="markdownIt-Anchor" href="#function函数"></a> function（函数）</h3>
<hr>
<p>函数可以添加修饰符，成为局部函数</p>
<p>函数可以作为数据赋值，可以作为参数传递</p>
<p>函数可以返回多个值</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">local function func(args)</span></span><br><span class="line"><span class="comment">	statements</span></span><br><span class="line"><span class="comment">end</span></span><br><span class="line"><span class="comment">--]]</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">"local"</span>)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	test() <span class="comment">--local</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">test2</span><span class="params">()</span></span></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">"global"</span>)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	test2() <span class="comment">--global</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(test)) <span class="comment">--nil</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(test2)) <span class="comment">--function</span></span><br><span class="line"><span class="comment">--函数作为数据赋值</span></span><br><span class="line">myprint = <span class="function"><span class="keyword">function</span><span class="params">(param)</span></span> <span class="comment">--function(param)是一个匿名函数，但是被赋值给了myprint</span></span><br><span class="line">   <span class="built_in">print</span>(<span class="string">"这是为的打印函数"</span>..param)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--函数作为参数赋值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">(num1,num2,printfunc)</span></span></span><br><span class="line">	printfunc(num1+num2)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">10</span>,<span class="number">20</span>,myprint)</span><br><span class="line"></span><br><span class="line"><span class="comment">--返回多个值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">temp</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span>,<span class="number">15</span>,<span class="number">20</span>,<span class="number">25</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">res = temp()</span><br><span class="line"><span class="built_in">print</span>(res) <span class="comment">--10</span></span><br><span class="line">res1,res2,res3,res4 = temp()</span><br><span class="line"><span class="built_in">print</span>(res1,res2,res3,res4) <span class="comment">--10 15 20 25</span></span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[=[C#</span></span><br><span class="line"><span class="comment">int fact(int n)&#123;</span></span><br><span class="line"><span class="comment">	if(n==1)</span></span><br><span class="line"><span class="comment">		return n;</span></span><br><span class="line"><span class="comment">	else</span></span><br><span class="line"><span class="comment">		return n * fact(n-1);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">--]=]</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fact</span><span class="params">(n)</span></span></span><br><span class="line">	<span class="keyword">if</span> n==<span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">		<span class="keyword">return</span> n</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> n*fact(n<span class="number">-1</span>)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(fact(<span class="number">3</span>))</span><br><span class="line">    </span><br><span class="line"><span class="comment">--函数作为数据赋值，fact赋值给了fact2</span></span><br><span class="line">fact2 = fact </span><br><span class="line"><span class="built_in">print</span>(fact2(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">--传递函数参数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">testfun</span><span class="params">(tab,fun)</span></span></span><br><span class="line">	<span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">pairs</span>(tab) <span class="keyword">do</span></span><br><span class="line">		fun(k,v)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">tab = &#123;key1 = <span class="string">"val1"</span>, key2 = <span class="string">"val2"</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span><span class="params">(k,v)</span></span></span><br><span class="line">	<span class="built_in">print</span>(k..<span class="string">": "</span>..v)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">testfun(tab,f1)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f2</span><span class="params">(k,v)</span></span></span><br><span class="line">	<span class="built_in">print</span>(k..<span class="string">" "</span>..v)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">testfun(tab,f2)</span><br><span class="line"></span><br><span class="line"><span class="comment">--使用匿名函数</span></span><br><span class="line">testfun(tab,</span><br><span class="line"><span class="function"><span class="keyword">function</span><span class="params">(k,v)</span></span></span><br><span class="line">	<span class="built_in">print</span>(k..<span class="string">"-"</span>..v)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>
<h4 id="可变参数"><a class="markdownIt-Anchor" href="#可变参数"></a> 可变参数</h4>
<p>函数可以接受的参数值可以是任意数量</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span><span class="params">(...)</span></span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"type of arg is "</span>..<span class="built_in">type</span>(<span class="built_in">arg</span>)) <span class="comment">--arg是接收到的所有参数的一个nil,最后一个值是接收到的arg的数量</span></span><br><span class="line">	<span class="keyword">local</span> <span class="built_in">arg</span> = &#123;...&#125; <span class="comment">--不会接收到传入参数的数量总和</span></span><br><span class="line">    <span class="keyword">local</span> res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">pairs</span>(<span class="built_in">arg</span>)<span class="keyword">do</span></span><br><span class="line">        res = res+v</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"合计"</span>..res)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"平均"</span>..res/#<span class="built_in">arg</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">sum()</span><br><span class="line">sum(<span class="number">10</span>)</span><br><span class="line">sum(<span class="number">11</span>,<span class="number">12</span>)</span><br><span class="line">sum(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br></pre></td></tr></table></figure></div>
<h3 id="thread线程"><a class="markdownIt-Anchor" href="#thread线程"></a> thread（线程）</h3>
<hr>
<p>表示执行的独立线程，用于执行协同程序</p>
<h3 id="userdata自定义类型"><a class="markdownIt-Anchor" href="#userdata自定义类型"></a> userdata（自定义类型）</h3>
<hr>
<h2 id="循环"><a class="markdownIt-Anchor" href="#循环"></a> 循环</h2>
<hr>
<blockquote>
<p>循环可以嵌套</p>
</blockquote>
<h3 id="while"><a class="markdownIt-Anchor" href="#while"></a> while</h3>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[=[</span></span><br><span class="line"><span class="comment">while(condition) do</span></span><br><span class="line"><span class="comment">    statements</span></span><br><span class="line"><span class="comment">end</span></span><br><span class="line"><span class="comment">--]=]</span></span><br><span class="line">a = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(a&lt;=<span class="number">20</span>) <span class="keyword">do</span></span><br><span class="line">	<span class="keyword">if</span>(a%<span class="number">2</span> == <span class="number">1</span>) <span class="keyword">then</span></span><br><span class="line">		<span class="built_in">print</span>(a)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	a = a+<span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></div>
<h3 id="for"><a class="markdownIt-Anchor" href="#for"></a> for</h3>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[=[</span></span><br><span class="line"><span class="comment">1.数值for循环</span></span><br><span class="line"><span class="comment">2.泛型for循环</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">for var=start,end,&lt;step&gt; do</span></span><br><span class="line"><span class="comment">	statements</span></span><br><span class="line"><span class="comment">end</span></span><br><span class="line"><span class="comment">--]=]</span></span><br><span class="line"><span class="comment">--数值for循环</span></span><br><span class="line"><span class="keyword">for</span> i=<span class="number">1</span>,<span class="number">10</span> <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">print</span>(i)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">for</span> i=<span class="number">20</span>,<span class="number">1</span>,<span class="number">-3</span> <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">print</span>(i)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--泛型for循环</span></span><br><span class="line">tab1 = &#123;key1 = <span class="number">10</span>, key2 = <span class="number">2</span>&#125;</span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">pairs</span>(tab1) <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">print</span>(k,v)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></div>
<h3 id="repeatuntil"><a class="markdownIt-Anchor" href="#repeatuntil"></a> repeat…until</h3>
<blockquote>
<p>类比do…while，先执行再判断</p>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[=[</span></span><br><span class="line"><span class="comment">repeat</span></span><br><span class="line"><span class="comment">    statements</span></span><br><span class="line"><span class="comment">until(condition) --满足条件停止执行</span></span><br><span class="line"><span class="comment">--]=]</span></span><br><span class="line">a=<span class="number">1</span></span><br><span class="line"><span class="keyword">repeat</span></span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line">    a = a+<span class="number">1</span></span><br><span class="line"><span class="keyword">until</span>(a==<span class="number">10</span>) <span class="comment">--输出1-9</span></span><br></pre></td></tr></table></figure></div>
<h2 id="iterator-迭代器"><a class="markdownIt-Anchor" href="#iterator-迭代器"></a> iterator 迭代器</h2>
<hr>
<ul>
<li>pairs遍历table所有内容</li>
<li>ipairs遍历table内连续索引，从1开始，遇到nil则停止</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">array = &#123;<span class="string">"Lua"</span>,<span class="string">"C#"</span>,<span class="string">"Java"</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">--pairs遍历所有内容</span></span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">pairs</span>(array) <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">print</span>(k,v)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- 1	Lua</span></span><br><span class="line"><span class="comment">-- 2	C#</span></span><br><span class="line"><span class="comment">-- 3	Java</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ipairs按照索引序号1,2,3,4顺序进行迭代，遇到nil则停止</span></span><br><span class="line">array[<span class="number">2</span>] = <span class="literal">nil</span></span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">ipairs</span>(array) <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">print</span>(k,v)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- 1	Lua</span></span><br></pre></td></tr></table></figure></div>
<h3 id="自定义迭代器"><a class="markdownIt-Anchor" href="#自定义迭代器"></a> 自定义迭代器</h3>
<p><code>for 变量列表 in 迭代函数，状态变量，控制变量 do statements end</code></p>
<ol>
<li>调用迭代器函数，把状态变量和控制变量当作参数传递给迭代函数，状态变量只会在第一次调用的时候赋值</li>
<li>如果迭代器的返回值为nil，退出当前循环<br>
如果不是nil，把返回值赋值给变量列表，并执行循环体，跳转到1</li>
</ol>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">array = &#123;<span class="string">"Lua"</span>,<span class="string">"C#"</span>,<span class="string">"Java"</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">--pairs遍历所有内容</span></span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">pairs</span>(array) <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">print</span>(k,v)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- 1	Lua</span></span><br><span class="line"><span class="comment">-- 2	C#</span></span><br><span class="line"><span class="comment">-- 3	Java</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ipairs按照索引序号1,2,3,4顺序进行迭代，遇到nil则停止</span></span><br><span class="line">array[<span class="number">2</span>] = <span class="literal">nil</span></span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">ipairs</span>(array) <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">print</span>(k,v)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- 1	Lua</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--迭代器和循环运行规则</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">square</span><span class="params">(state,control)</span></span></span><br><span class="line">	<span class="keyword">if</span>(control&gt;=state) <span class="keyword">then</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		control = control + <span class="number">1</span> <span class="comment">--返回给控制变量供下次迭代使用</span></span><br><span class="line">		<span class="keyword">return</span> control,control*control</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> square,<span class="number">9</span>,<span class="number">0</span> <span class="keyword">do</span> <span class="comment">--状态变量表示总共要迭代的次数，控制变量表示当前迭代的次数</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"square"</span>,i,j)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></div>
<h2 id="流程控制逻辑判断"><a class="markdownIt-Anchor" href="#流程控制逻辑判断"></a> 流程控制(逻辑判断)</h2>
<hr>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--只有nil和false代表false</span></span><br><span class="line"><span class="comment">--其它都代表true，包括0</span></span><br><span class="line"><span class="comment">--[=[</span></span><br><span class="line"><span class="comment">if(布尔表达式) then</span></span><br><span class="line"><span class="comment">	statements</span></span><br><span class="line"><span class="comment">end</span></span><br><span class="line"><span class="comment">--]=]</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>)<span class="keyword">then</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">10</span></span><br><span class="line"><span class="keyword">if</span>(a&gt;<span class="number">10</span>)<span class="keyword">then</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"a大于10"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--if(boolean)then..end</span></span><br><span class="line"><span class="keyword">if</span> a&lt;=<span class="number">10</span> <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"a小于等于10"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--if(boolean)then..else..end</span></span><br><span class="line"><span class="keyword">if</span>(b) <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"b不为空"</span>)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"b为空"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--if()then..elseif()then..elseif()then..elseif()then..else..end</span></span><br><span class="line">b=<span class="number">3</span></span><br><span class="line"><span class="keyword">if</span>(b==<span class="number">1</span>)<span class="keyword">then</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"b=1"</span>)</span><br><span class="line"><span class="keyword">elseif</span>(b==<span class="number">2</span>)<span class="keyword">then</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"b=2"</span>)</span><br><span class="line"><span class="keyword">elseif</span>(b==<span class="number">3</span>)<span class="keyword">then</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"b=3"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></div>
<h2 id="运算符"><a class="markdownIt-Anchor" href="#运算符"></a> 运算符</h2>
<hr>
<h3 id="数学运算符"><a class="markdownIt-Anchor" href="#数学运算符"></a> 数学运算符</h3>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 数学运算符</span></span><br><span class="line"><span class="comment">-- = + - * / % ^ -</span></span><br><span class="line">a = <span class="number">10</span></span><br><span class="line">b = <span class="number">20</span></span><br><span class="line"><span class="built_in">print</span>(a+b) <span class="comment">--30</span></span><br><span class="line"><span class="built_in">print</span>(a-b) <span class="comment">-- -10</span></span><br><span class="line"><span class="built_in">print</span>(a/b) <span class="comment">--0.5</span></span><br><span class="line"><span class="built_in">print</span>(a%b) <span class="comment">--10</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">2.1</span></span><br><span class="line">b = <span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(a%b) <span class="comment">--0.1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">2</span>^<span class="number">4</span>) <span class="comment">--16</span></span><br><span class="line"><span class="built_in">print</span>(-a) <span class="comment">-- -2.1</span></span><br><span class="line">a = -a</span><br><span class="line"><span class="built_in">print</span>(-a) <span class="comment">--2.1</span></span><br></pre></td></tr></table></figure></div>
<h3 id="关系运算符"><a class="markdownIt-Anchor" href="#关系运算符"></a> 关系运算符</h3>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--关系运算符，结果是bool</span></span><br><span class="line"><span class="comment">-- == ~= &lt; &gt; &lt;= &gt;=</span></span><br><span class="line">a = <span class="number">25</span></span><br><span class="line">b = <span class="number">30</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a==b)<span class="keyword">then</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"a==b"</span>)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"a~=b"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a&lt;b)<span class="keyword">then</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"a&lt;b"</span>)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"a&gt;=b"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></div>
<h3 id="逻辑运算符"><a class="markdownIt-Anchor" href="#逻辑运算符"></a> 逻辑运算符</h3>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--逻辑运算符，结果是bool</span></span><br><span class="line"><span class="comment">-- and or not</span></span><br><span class="line"><span class="comment">-- a and b a,b都满足，则返回true</span></span><br><span class="line"><span class="comment">-- a or b  a,b至少有一个满足，则返回true</span></span><br><span class="line"><span class="comment">-- not a   a为false则为true，为true则为false</span></span><br><span class="line">a = <span class="literal">true</span></span><br><span class="line">b = <span class="literal">false</span></span><br><span class="line"><span class="built_in">print</span>(a <span class="keyword">and</span> b) <span class="comment">--false</span></span><br><span class="line"><span class="built_in">print</span>(a <span class="keyword">and</span> <span class="keyword">not</span> b) <span class="comment">--true</span></span><br><span class="line"><span class="built_in">print</span>(a <span class="keyword">or</span> b) <span class="comment">--true</span></span><br><span class="line"><span class="built_in">print</span>(<span class="keyword">not</span> b <span class="keyword">or</span> a) <span class="comment">--true</span></span><br><span class="line"><span class="built_in">print</span>(<span class="keyword">not</span>(b <span class="keyword">or</span> a)) <span class="comment">--false</span></span><br><span class="line"><span class="built_in">print</span>(<span class="keyword">not</span> b) <span class="comment">--true</span></span><br></pre></td></tr></table></figure></div>
<h1 id="模块"><a class="markdownIt-Anchor" href="#模块"></a> 模块</h1>
<hr>
<p>模块类似于封装库</p>
<h2 id="定义module"><a class="markdownIt-Anchor" href="#定义module"></a> 定义module</h2>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 文件名 module.lua</span></span><br><span class="line"><span class="comment">--定义module</span></span><br><span class="line">module = &#123;&#125;</span><br><span class="line">module.var = <span class="string">"yooziki"</span> <span class="comment">--放置变量</span></span><br><span class="line">module.func1 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"这个是module里的函数"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">module2 = &#123;&#125;</span><br><span class="line">module2.var = <span class="string">"yooziki"</span> <span class="comment">--放置变量</span></span><br><span class="line">module2.func1 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"这个是module2里的函数"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--=====================</span></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">func2</span><span class="params">()</span></span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"这个是局部函数func2"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func3</span><span class="params">()</span></span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"这个是全局函数func3"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func4</span><span class="params">()</span></span></span><br><span class="line">	func2()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--=====================</span></span><br><span class="line"><span class="keyword">return</span> module,module2</span><br></pre></td></tr></table></figure></div>
<h2 id="使用module"><a class="markdownIt-Anchor" href="#使用module"></a> 使用module</h2>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 同级文件夹中</span></span><br><span class="line"><span class="comment">--使用module</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--require "模块名"</span></span><br><span class="line"><span class="comment">--require ("模块名")</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span> <span class="string">"module"</span></span><br><span class="line"><span class="comment">-- m= require "module"</span></span><br><span class="line">module.func1() <span class="comment">--这个是module里的函数</span></span><br><span class="line">module2.func1() <span class="comment">--这个是module2里的函数</span></span><br><span class="line"></span><br><span class="line">func2() <span class="comment">--运行错误，此为局部函数</span></span><br><span class="line">func3() <span class="comment">--这个是全局函数func3</span></span><br><span class="line">func4() <span class="comment">--这个是局部函数func2，可以借助全局函数访问局部函数</span></span><br></pre></td></tr></table></figure></div>
<blockquote>
<p>require后面的模块名应该是包含该模块的lua文件的名字</p>
<p>引入后，就可以调用require文件内部的所有module了</p>
</blockquote>
<h1 id="c包"><a class="markdownIt-Anchor" href="#c包"></a> C包</h1>
<hr>
<p>Lua和C是很容易结合的，使用 C 为 Lua 写包。</p>
<p>与Lua中写包不同，C包在使用以前必须首先加载并连接，在大多数系统中最容易的实现方式是通过动态连接库机制。</p>
<p>Lua在一个叫loadlib的函数内提供了所有的动态连接的功能。这个函数有两个参数:库的绝对路径和初始化函数。所以典型的调用的例子如下:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> <span class="built_in">path</span> = <span class="string">"/usr/local/lua/lib/libluasocket.so"</span></span><br><span class="line"><span class="keyword">local</span> f = <span class="built_in">loadlib</span>(<span class="built_in">path</span>, <span class="string">"luaopen_socket"</span>)</span><br></pre></td></tr></table></figure></div>
<p>loadlib 函数加载指定的库并且连接到 Lua，然而它并不打开库（也就是说没有调用初始化函数），反之他返回初始化函数作为 Lua 的一个函数，这样我们就可以直接在Lua中调用他。</p>
<p>如果加载动态库或者查找初始化函数时出错，loadlib 将返回 nil 和错误信息。我们可以修改前面一段代码，使其检测错误然后调用初始化函数：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> <span class="built_in">path</span> = <span class="string">"/usr/local/lua/lib/libluasocket.so"</span></span><br><span class="line"><span class="comment">-- 或者 path = "C:\\windows\\luasocket.dll"，这是 Window 平台下</span></span><br><span class="line"><span class="keyword">local</span> f = <span class="built_in">assert</span>(<span class="built_in">loadlib</span>(<span class="built_in">path</span>, <span class="string">"luaopen_socket"</span>))</span><br><span class="line">f()  <span class="comment">-- 真正打开库</span></span><br></pre></td></tr></table></figure></div>
<p>一般情况下我们期望二进制的发布库包含一个与前面代码段相似的 stub 文件，安装二进制库的时候可以随便放在某个目录，只需要修改 stub 文件对应二进制库的实际路径即可。</p>
<p>将 stub 文件所在的目录加入到 LUA_PATH，这样设定后就可以使用 require 函数加载 C 库了。</p>
<h1 id="协同程序coroutine"><a class="markdownIt-Anchor" href="#协同程序coroutine"></a> 协同程序（coroutine）</h1>
<hr>
<p>类似于线程，拥有独立的堆栈、独立局部变量、独立指令指针、同时又与其它协同程序共享全局变量和其它大部分内容</p>
<p>同一线程下的协程同一时刻只能运行一条协程（伪多线程）</p>
<h2 id="定义和启动协同函数"><a class="markdownIt-Anchor" href="#定义和启动协同函数"></a> 定义和启动协同函数</h2>
<hr>
<h3 id="方法1"><a class="markdownIt-Anchor" href="#方法1"></a> 方法1</h3>
<ul>
<li>定义：<code>coroutine.create(function(...)...end)</code></li>
<li>启动：<code>coroutine.resume(function,arg1,arg2...)</code></li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--定义协同函数，方法1 </span></span><br><span class="line">co = coroutine.<span class="built_in">create</span>(</span><br><span class="line">	<span class="function"><span class="keyword">function</span><span class="params">(a,b)</span></span></span><br><span class="line">		<span class="built_in">print</span>(a+b)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">)</span><br><span class="line">coroutine.<span class="built_in">resume</span>(co,<span class="number">20</span>,<span class="number">30</span>) <span class="comment">--50</span></span><br></pre></td></tr></table></figure></div>
<h3 id="方法2"><a class="markdownIt-Anchor" href="#方法2"></a> 方法2</h3>
<ul>
<li>定义：<code>coroutine.wrap(function(...)...end)</code></li>
<li>启动：<code>cofunction(args)</code></li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">----定义协同函数，方法2</span></span><br><span class="line">co = coroutine.<span class="built_in">wrap</span>(</span><br><span class="line">	<span class="function"><span class="keyword">function</span><span class="params">(a,b)</span></span></span><br><span class="line">		<span class="built_in">print</span>(a*b)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">)</span><br><span class="line">co(<span class="number">2</span>,<span class="number">3</span>) <span class="comment">--6</span></span><br></pre></td></tr></table></figure></div>
<h2 id="暂停-继续和返回值"><a class="markdownIt-Anchor" href="#暂停-继续和返回值"></a> 暂停、继续和返回值</h2>
<hr>
<ul>
<li>暂停（挂起）方法<code>coroutine.yield(&lt;args&gt;)</code>，args是暂停时需要传递出去的内容，可以选择性填写<br>
如果存在<code>var = coroutine.yield()</code>，那么在下一次<code>coroutine.resume()</code>时候可以传入一个新的值作为var的值</li>
<li>继续运行的方法<code>coroutine.resume(function)</code></li>
<li>返回值：协同程序的返回值可以是多个的
<ul>
<li>第一个返回值一定是布尔值，表示协程启动成功与否</li>
<li>后面的返回值按照协程return顺序排列，return不是必须的</li>
</ul>
</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">co = coroutine.<span class="built_in">create</span>(</span><br><span class="line">	<span class="function"><span class="keyword">function</span><span class="params">(a,b)</span></span></span><br><span class="line">		<span class="built_in">print</span>(a+b)</span><br><span class="line">		coroutine.<span class="built_in">yield</span>(a*b)</span><br><span class="line">		<span class="built_in">print</span>(a*b)</span><br><span class="line">		<span class="keyword">return</span> a/b,a-b</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">)</span><br><span class="line">res1,res2 = coroutine.<span class="built_in">resume</span>(co,<span class="number">4</span>,<span class="number">5</span>) <span class="comment">--9</span></span><br><span class="line"><span class="built_in">print</span>(res1,res2) <span class="comment">--true	20</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"yield!"</span>) <span class="comment">--yield</span></span><br><span class="line">res1,res2,res3 = coroutine.<span class="built_in">resume</span>(co) <span class="comment">--20</span></span><br><span class="line"><span class="built_in">print</span>(res1,res2,res3) <span class="comment">--true	0.8		-1</span></span><br><span class="line"></span><br><span class="line">&gt;&gt;<span class="number">9</span></span><br><span class="line">&gt;&gt;<span class="literal">true</span>	<span class="number">20</span></span><br><span class="line">&gt;&gt;<span class="built_in">yield</span></span><br><span class="line">&gt;&gt;<span class="number">20</span></span><br><span class="line">&gt;&gt;<span class="literal">true</span>	<span class="number">0.8</span>		<span class="number">-1</span></span><br></pre></td></tr></table></figure></div>
<h2 id="查看协同程序状态"><a class="markdownIt-Anchor" href="#查看协同程序状态"></a> 查看协同程序状态</h2>
<p><code>coroutine.status()</code>，有三种返回情况，suspended（暂停），running（运行中），dead（死亡，运行结束）</p>
<p>协程执行完成后，无法被再次调用</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(coroutine.<span class="built_in">status</span>(co)) <span class="comment">--dead</span></span><br><span class="line">co = coroutine.<span class="built_in">create</span>(</span><br><span class="line">	<span class="function"><span class="keyword">function</span><span class="params">(a,b)</span></span></span><br><span class="line">		<span class="built_in">print</span>(a+b)</span><br><span class="line">		<span class="built_in">print</span>(coroutine.<span class="built_in">status</span>(co)) <span class="comment">--running</span></span><br><span class="line">		coroutine.<span class="built_in">yield</span>()</span><br><span class="line">		<span class="built_in">print</span>(a*b)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(coroutine.<span class="built_in">status</span>(co)) <span class="comment">--suspended</span></span><br><span class="line">coroutine.<span class="built_in">resume</span>(co,<span class="number">2</span>,<span class="number">6</span>)</span><br><span class="line">coroutine.<span class="built_in">resume</span>(co)</span><br><span class="line"><span class="built_in">print</span>(coroutine.<span class="built_in">status</span>(co)) <span class="comment">--dead</span></span><br><span class="line"></span><br><span class="line">&gt;&gt;dead</span><br><span class="line">&gt;&gt;suspended</span><br><span class="line">&gt;&gt;<span class="number">8</span></span><br><span class="line">&gt;&gt;<span class="built_in">running</span></span><br><span class="line">&gt;&gt;<span class="number">12</span></span><br><span class="line">&gt;&gt;dead</span><br></pre></td></tr></table></figure></div>
<h2 id="协程复制"><a class="markdownIt-Anchor" href="#协程复制"></a> 协程复制</h2>
<hr>
<p>等号复制是浅复制</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">co = coroutine.<span class="built_in">create</span>(</span><br><span class="line">	<span class="function"><span class="keyword">function</span><span class="params">(a,b)</span></span></span><br><span class="line">		<span class="built_in">print</span>(a+b)</span><br><span class="line">		coroutine.<span class="built_in">yield</span>()</span><br><span class="line">		<span class="built_in">print</span>(a*b)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">)</span><br><span class="line">co1 = co</span><br><span class="line">coroutine.<span class="built_in">resume</span>(co1,<span class="number">2</span>,<span class="number">6</span>)</span><br><span class="line">coroutine.<span class="built_in">resume</span>(co)</span><br><span class="line"></span><br><span class="line">&gt;&gt;<span class="number">8</span></span><br><span class="line">&gt;&gt;<span class="number">12</span></span><br></pre></td></tr></table></figure></div>
<h2 id="查看当前运行协程的协程号"><a class="markdownIt-Anchor" href="#查看当前运行协程的协程号"></a> 查看当前运行协程的协程号</h2>
<hr>
<p><code>coroutine.runnign()</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">"%20s"</span>,<span class="string">"查看状态"</span>))</span><br><span class="line">co = coroutine.<span class="built_in">create</span>(</span><br><span class="line">	<span class="function"><span class="keyword">function</span><span class="params">(a,b)</span></span></span><br><span class="line">		<span class="built_in">print</span>(a+b)</span><br><span class="line">		<span class="built_in">print</span>(coroutine.<span class="built_in">running</span>()) <span class="comment">--thread: 0074DCD0</span></span><br><span class="line">		coroutine.<span class="built_in">yield</span>(a*b)</span><br><span class="line">		<span class="built_in">print</span>(a*b)</span><br><span class="line">		<span class="keyword">return</span> a/b,a-b</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">)</span><br><span class="line">coroutine.<span class="built_in">resume</span>(co,<span class="number">2</span>,<span class="number">6</span>)</span><br><span class="line">coroutine.<span class="built_in">resume</span>(co)</span><br><span class="line"></span><br><span class="line">&gt;&gt;<span class="number">8</span></span><br><span class="line">&gt;&gt;thread: <span class="number">0074</span>DCD0</span><br><span class="line">&gt;&gt;<span class="number">12</span></span><br></pre></td></tr></table></figure></div>
<h2 id="案例"><a class="markdownIt-Anchor" href="#案例"></a> 案例</h2>
<hr>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">(a)</span></span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"function| foo函数输出"</span>,a)</span><br><span class="line">	<span class="keyword">return</span> coroutine.<span class="built_in">yield</span>(<span class="number">2</span>*a) <span class="comment">--返回yield，yield返回2*a</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">co = coroutine.<span class="built_in">create</span>(</span><br><span class="line">	<span class="function"><span class="keyword">function</span><span class="params">(a,b)</span></span></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">"thread  | 第一次协程执行输出"</span>,a,b)</span><br><span class="line">		<span class="keyword">local</span> r = foo(a+<span class="number">1</span>) <span class="comment">--return的yield使协程暂停，并返回(a+1)*2</span></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">"thread  | 第二次协程执行输出"</span>,r) <span class="comment">--协程里接受传入参数的，必须是已经存在的参数，而且是local类型</span></span><br><span class="line">		<span class="keyword">local</span> r,s = coroutine.<span class="built_in">yield</span>(a+b,a-b) <span class="comment">--yield的左值会申请两个新的待接受变量r,s  等待resume传入</span></span><br><span class="line"></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">"thread  | 第三次协程执行输出"</span>,r,s)</span><br><span class="line">		<span class="keyword">return</span> b,<span class="string">"协程结束"</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"main    |"</span>,coroutine.<span class="built_in">resume</span>(co,<span class="number">1</span>,<span class="number">10</span>)) <span class="comment">--启动协程</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"main    |"</span>,coroutine.<span class="built_in">resume</span>(co,<span class="string">"r"</span>)) <span class="comment">--这里传入一个参数</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"main    |"</span>,coroutine.<span class="built_in">resume</span>(co,<span class="string">"x"</span>,<span class="string">"y"</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"main    |"</span>,coroutine.<span class="built_in">resume</span>(co,<span class="string">"x"</span>,<span class="string">"y"</span>)) <span class="comment">--已经结束，无法被调用</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;thread  | 第一次协程执行输出	<span class="number">1</span>	<span class="number">10</span></span><br><span class="line">&gt;&gt;<span class="function"><span class="keyword">function</span>| <span class="title">foo</span>函数输出	2</span></span><br><span class="line"><span class="function">&gt;&gt;<span class="title">main</span>    |	<span class="title">true</span>	4</span></span><br><span class="line"><span class="function">&gt;&gt;<span class="title">thread</span>  | 第二次协程执行输出	<span class="title">r</span></span></span><br><span class="line"><span class="function">&gt;&gt;<span class="title">main</span>    |	<span class="title">true</span>	11	-9</span></span><br><span class="line"><span class="function">&gt;&gt;<span class="title">thread</span>  | 第三次协程执行输出	<span class="title">x</span>	<span class="title">y</span></span></span><br><span class="line"><span class="function">&gt;&gt;<span class="title">main</span>    |	<span class="title">true</span>	10	协程结束</span></span><br><span class="line"><span class="function">&gt;&gt;<span class="title">main</span>    |	<span class="title">false</span>	<span class="title">cannot</span> <span class="title">resume</span> <span class="title">dead</span> <span class="title">coroutine</span></span></span><br></pre></td></tr></table></figure></div>
<h1 id="文件读写io"><a class="markdownIt-Anchor" href="#文件读写io"></a> 文件读写（I/O）</h1>
<hr>
<p>打开文件<code>f = io.open(filename&lt;,mode&gt;)</code></p>
<h2 id="对于mode"><a class="markdownIt-Anchor" href="#对于mode"></a> 对于mode</h2>
<hr>
<table>
<thead>
<tr>
<th>模式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>r</td>
<td>只读方式，文件必须存在</td>
</tr>
<tr>
<td>w</td>
<td>只写方式，若文件存在则文件长度清零，若不存在则新建</td>
</tr>
<tr>
<td>a</td>
<td>以附加方式打开只写。若文件不存在则新建，若文件存在则往文件尾添加内容，原有内容会被保留（EOF符保留）</td>
</tr>
<tr>
<td>r+</td>
<td>以可读可写方式打开，文件必须存在</td>
</tr>
<tr>
<td>w+</td>
<td>可读写方式打开，若文件存在则文件长度清零，若不存在则新建</td>
</tr>
<tr>
<td>a+</td>
<td>可读可写，其它与a系统</td>
</tr>
<tr>
<td>b</td>
<td>二进制模式，如果文件是二进制文件，可以加上b，例如rb</td>
</tr>
<tr>
<td>+</td>
<td>表示对文件即可读也可写，如rb+</td>
</tr>
</tbody>
</table>
<h2 id="简单模式文件读写-simple-model"><a class="markdownIt-Anchor" href="#简单模式文件读写-simple-model"></a> 简单模式文件读写 simple model</h2>
<hr>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--只读方式打开文件</span></span><br><span class="line">f = <span class="built_in">io</span>.<span class="built_in">open</span>(<span class="string">"data1.txt"</span>,<span class="string">"r"</span>)</span><br><span class="line"><span class="comment">--设置默认输入文件为f</span></span><br><span class="line"><span class="built_in">io</span>.<span class="built_in">input</span>(f)</span><br><span class="line"><span class="comment">--读取一行文件</span></span><br><span class="line">s = <span class="built_in">io</span>.<span class="built_in">read</span>()</span><br><span class="line"><span class="keyword">while</span>(s~=<span class="literal">nil</span>) <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">print</span>(s)</span><br><span class="line">	s = <span class="built_in">io</span>.<span class="built_in">read</span>()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--关闭文件</span></span><br><span class="line"><span class="built_in">io</span>.<span class="built_in">close</span>(f)</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">io</span>.<span class="built_in">open</span>(<span class="string">"data1.txt"</span>,<span class="string">"a"</span>)</span><br><span class="line"><span class="comment">--设置默认输出文件为f</span></span><br><span class="line"><span class="built_in">io</span>.<span class="built_in">output</span>(f)</span><br><span class="line"><span class="comment">--在文件最后一行添加内容</span></span><br><span class="line"><span class="built_in">io</span>.<span class="built_in">write</span>(<span class="string">"xxxx"</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">io</span>.<span class="built_in">close</span>(f)</span><br></pre></td></tr></table></figure></div>
<h3 id="ioreadarg"><a class="markdownIt-Anchor" href="#ioreadarg"></a> io.read(arg)</h3>
<ul>
<li><code>&quot;*n&quot;</code>,读取一个数字并返回</li>
<li><code>&quot;*a&quot;</code>从当前位置读取整个文件</li>
<li><code>*l</code>（默认）读取下一行，在EOF处返回nil</li>
<li>number，返回指定字符个数的字符串，或在EOF处返回nil</li>
</ul>
<h3 id="iotmpfile"><a class="markdownIt-Anchor" href="#iotmpfile"></a> io.tmpfile()</h3>
<p>返回一个临时文件句柄，该文件以更新模式打开，程序结束时自动删除</p>
<h3 id="iotypefile"><a class="markdownIt-Anchor" href="#iotypefile"></a> io.type(file)</h3>
<p>检测file是否是一个可用的文件句柄</p>
<h3 id="ioflush"><a class="markdownIt-Anchor" href="#ioflush"></a> io.flush()</h3>
<p>向文件写入缓冲中的所有数据。在程序结束或者调用<code>io.close(file)</code>前，<code>io.write</code>都是写入到缓冲区中的，通过主动调用flush提前写入内容，并刷新缓冲区</p>
<h3 id="iolinesoptional-file-name"><a class="markdownIt-Anchor" href="#iolinesoptional-file-name"></a> io.lines(optional file name)</h3>
<p>返回一个迭代函数，每次调用将获得文件中一行的内容。当到文件尾时，返回nil，但不关闭文件</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">io</span>.<span class="built_in">lines</span>(<span class="string">"data1.txt"</span>) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(line)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></div>
<h2 id="完全模式文件读写-complete-model"><a class="markdownIt-Anchor" href="#完全模式文件读写-complete-model"></a> 完全模式文件读写 complete model</h2>
<hr>
<p>利用<code>file:xxx</code>语法进行读取，与简单模式相比，可以单词读写多个文件</p>
<p>方法与简单模式对应</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--完全读写模式</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">"%20s"</span>,<span class="string">"完全读写模式"</span>))</span><br><span class="line">file = <span class="built_in">io</span>.<span class="built_in">open</span>(<span class="string">"data1.txt"</span>,<span class="string">"r"</span>)</span><br><span class="line"><span class="built_in">print</span>(file:<span class="built_in">read</span>(<span class="string">"*a"</span>))</span><br><span class="line">file:<span class="built_in">close</span>()</span><br></pre></td></tr></table></figure></div>
<ul>
<li>
<p>file:seek(optional whence, optional offset)<br>
设置和获取当前文件位置，成功则返回最终的文件位置(按字节)，失败这返回nil加错误信息<br>
参数whence可以是</p>
<ul>
<li><code>&quot;set&quot;</code>从文件头开始</li>
<li><code>&quot;cur&quot;</code>从文件当前位置开始[默认]</li>
<li><code>&quot;end&quot;</code>从文件尾开始</li>
<li><code>offset</code>默认为0</li>
</ul>
<p>不带参数<code>file:seek()</code>返回当前位置，<code>file:seek(&quot;set&quot;)</code>则定位到文件头，<code>file:seek(&quot;end&quot;)</code>则定位到文件尾并返回文件大小<br>
<code>file:seek(&quot;end&quot;,-25)</code>文件末尾倒数25位的地方开始读取</p>
</li>
<li>
<p>file:lush()<br>
向文件写入缓冲中的所有数据</p>
</li>
</ul>
<h1 id="错误处理"><a class="markdownIt-Anchor" href="#错误处理"></a> 错误处理</h1>
<hr>
<ul>
<li>语法错误</li>
<li>运行错误</li>
</ul>
<h2 id="错误处理-2"><a class="markdownIt-Anchor" href="#错误处理-2"></a> <a href="https://www.runoob.com/lua/lua-error-handling.html">错误处理</a></h2>
<hr>
<ul>
<li>assert(try, message)<br>
会先试运行try部分的内容，如果失败则抛出message的内容作为错误的抛出</li>
<li>error(message&lt;, level&gt;)<br>
终止正在执行的函数，并返回message的内容作为错误信息<br>
通常情况下，error会附加一些错误位置的信息到message头部<br>
Level参数指示获得错误的位置
<ul>
<li>level = 1[默认]  - 为调用error位置</li>
<li>level = 2  - 指出那个调用error的函数的函数</li>
<li>level = 0 - 不添加错误位置信息</li>
</ul>
</li>
</ul>
<h2 id="调试debug"><a class="markdownIt-Anchor" href="#调试debug"></a> <a href="https://www.runoob.com/lua/lua-debug.html">调试（debug）</a></h2>
<hr>
<p>Lua 提供了 debug 库用于提供创建我们自定义调试器的功能。Lua 本身并未有内置的调试器，但很多开发者共享了他们的 Lua 调试器代码。</p>
<h2 id="垃圾回收机制"><a class="markdownIt-Anchor" href="#垃圾回收机制"></a> 垃圾回收机制</h2>
<hr>
<p>Lua 采用了自动内存管理。 这意味着你不用操心新创建的对象需要的内存如何分配出来， 也不用考虑在对象不再被使用后怎样释放它们所占用的内存。</p>
<p>Lua 运行了一个<strong>垃圾收集器</strong>来收集所有<strong>死对象</strong> （即在 Lua 中不可能再访问到的对象）来完成自动内存管理的工作。 Lua 中所有用到的内存，如：字符串、表、用户数据、函数、线程、 内部结构等，都服从自动管理。</p>
<p>Lua 实现了一个增量标记-扫描收集器。 它使用这两个数字来控制垃圾收集循环： 垃圾收集器间歇率和垃圾收集器步进倍率。 这两个数字都使用百分数为单位 （例如：值 100 在内部表示 1 ）。</p>
<p>垃圾收集器间歇率控制着收集器需要在开启新的循环前要等待多久。 增大这个值会减少收集器的积极性。 当这个值比 100 小的时候，收集器在开启新的循环前不会有等待。 设置这个值为 200 就会让收集器等到总内存使用量达到 之前的两倍时才开始新的循环。</p>
<p>垃圾收集器步进倍率控制着收集器运作速度相对于内存分配速度的倍率。 增大这个值不仅会让收集器更加积极，还会增加每个增量步骤的长度。 不要把这个值设得小于 100 ， 那样的话收集器就工作的太慢了以至于永远都干不完一个循环。 默认值是 200 ，这表示收集器以内存分配的&quot;两倍&quot;速工作。</p>
<p>如果你把步进倍率设为一个非常大的数字 （比你的程序可能用到的字节数还大 10% ）， 收集器的行为就像一个 stop-the-world 收集器。 接着你若把间歇率设为 200 ， 收集器的行为就和过去的 Lua 版本一样了： 每次 Lua 使用的内存翻倍时，就做一次完整的收集。</p>
<h3 id="垃圾回收器函数"><a class="markdownIt-Anchor" href="#垃圾回收器函数"></a> 垃圾回收器函数</h3>
<p>Lua 提供了以下函数**collectgarbage ([opt [, arg]])**用来控制自动内存管理:</p>
<ul>
<li><strong>collectgarbage(“collect”):</strong> 做一次完整的垃圾收集循环。通过参数 opt 它提供了一组不同的功能：</li>
<li><strong>collectgarbage(“count”):</strong> 以 K 字节数为单位返回 Lua 使用的总内存数。 这个值有小数部分，所以只需要乘上 1024 就能得到 Lua 使用的准确字节数（除非溢出）。</li>
<li><strong>collectgarbage(“restart”):</strong> 重启垃圾收集器的自动运行。</li>
<li><strong>collectgarbage(“setpause”):</strong> 将 arg 设为收集器的 间歇率。 返回 间歇率 的前一个值。</li>
<li><strong>collectgarbage(“setstepmul”):</strong> 返回 步进倍率 的前一个值。</li>
<li><strong>collectgarbage(“step”):</strong> 单步运行垃圾收集器。 步长&quot;大小&quot;由 arg 控制。 传入 0 时，收集器步进（不可分割的）一步。 传入非 0 值， 收集器收集相当于 Lua 分配这些多（K 字节）内存的工作。 如果收集器结束一个循环将返回 true 。</li>
<li><strong>collectgarbage(“stop”):</strong> 停止垃圾收集器的运行。 在调用重启前，收集器只会因显式的调用运行。</li>
</ul>
<h1 id="面向对象"><a class="markdownIt-Anchor" href="#面向对象"></a> 面向对象</h1>
<hr>
<p>利用table实现</p>
<p>对于一个对象来说，需要有属性和方法，可以封装到table中</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--利用table实现</span></span><br><span class="line">person = &#123;name = <span class="string">"yooziki"</span>,age = <span class="number">22</span>&#125;</span><br><span class="line">person.eat = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">	<span class="built_in">print</span>(person.name..<span class="string">"在吃饭"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">person.eat() <span class="comment">--yooziki在吃饭</span></span><br></pre></td></tr></table></figure></div>
<p>这段代码看起来实现了类的功能，但是问题还比较大。比如在function内部，限定了必须将类的名字命名为person才能生效<code>print(person.name..&quot;在吃饭&quot;)</code>，因此无法实例化</p>
<p>使用冒号语法解决这个问题，冒号语法定义的函数，会自动将表传递到函数内部，作为self的值</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--冒号语法实现</span></span><br><span class="line">person = &#123;name = <span class="string">"yooziki"</span>,age = <span class="number">22</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">person:eat</span><span class="params">()</span></span>  <span class="comment">--通过冒号定义的时候，self会自动传递</span></span><br><span class="line">	<span class="built_in">print</span>(self.name..<span class="string">"在吃饭"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">person:eat() <span class="comment">--yooziki在吃饭</span></span><br><span class="line">a = person</span><br><span class="line">a:eat() <span class="comment">----yooziki在吃饭</span></span><br></pre></td></tr></table></figure></div>
<p>但是由于表的复制是浅复制，依然无法实现实例化。但是可以利用元表的特性，仿照一种实例化方式</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--利用table实现</span></span><br><span class="line">Person = &#123;name = <span class="string">"yooziki"</span>,age = <span class="number">22</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person:eat</span><span class="params">()</span></span></span><br><span class="line">	<span class="built_in">print</span>(self.name..<span class="string">"在吃饭"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person:new</span><span class="params">()</span></span></span><br><span class="line">	<span class="keyword">local</span> t = &#123;&#125;</span><br><span class="line">	<span class="built_in">setmetatable</span>(t,&#123;<span class="built_in">__index</span> = self&#125;) <span class="comment">--调用一个key的时候，如果t中不存在，则会在__index所指定的表中查找</span></span><br><span class="line">	<span class="keyword">return</span> t</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">person1 = Person:new()</span><br><span class="line">person2 = Person:new()</span><br><span class="line"></span><br><span class="line">person1.name = <span class="string">"YOO"</span>  <span class="comment">--往person1表中新添加name，下次访问不会再查找__index中的属性（被覆盖）</span></span><br><span class="line">person2.name = <span class="string">"ZIKI"</span> <span class="comment">--往person2中新添加name</span></span><br><span class="line"></span><br><span class="line">person1:eat() <span class="comment">--YOO在吃饭</span></span><br><span class="line">person2:eat() <span class="comment">--ZIKI在吃饭</span></span><br></pre></td></tr></table></figure></div>
<p>将模版表（类）作为新表的元表的__index指定的表，既可以使用模板表的所有内容，也可以覆写和新增（继承和派生）</p>
<ul>
<li>继承<br>
利用了元表可以级联调用的特性，以及冒号语法传递self的特性</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--利用table实现</span></span><br><span class="line">Person = &#123;name = <span class="string">"yooziki"</span>,age = <span class="number">22</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person:eat</span><span class="params">()</span></span></span><br><span class="line">	<span class="built_in">print</span>(self.name..<span class="string">"在吃饭"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person:new</span><span class="params">()</span></span></span><br><span class="line">	<span class="keyword">local</span> t = &#123;&#125;</span><br><span class="line">	<span class="built_in">setmetatable</span>(t,&#123;<span class="built_in">__index</span> = self&#125;) <span class="comment">--调用一个key的时候，如果t中不存在，则会在__index所指定的表中查找</span></span><br><span class="line">	<span class="keyword">return</span> t</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">Student = Person:new()</span><br><span class="line">Teacher = Person:new()</span><br><span class="line"></span><br><span class="line">Student.grade = <span class="number">1</span></span><br><span class="line">Student.name = <span class="string">"学生"</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student:showGrade</span><span class="params">()</span></span></span><br><span class="line">   <span class="built_in">print</span>(self.name..<span class="string">"年级是"</span>..self.grade)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">Teacher.rank = <span class="string">"高级"</span></span><br><span class="line">Teacher.name = <span class="string">"老师"</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Teacher:showRank</span><span class="params">()</span></span></span><br><span class="line">   <span class="built_in">print</span>(self.name..<span class="string">"的教资是"</span>..self.rank)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">---继承</span></span><br><span class="line">stu1 = Student:new()</span><br><span class="line">teacher1 = Teacher:new()</span><br><span class="line"></span><br><span class="line">stu1:showGrade() <span class="comment">--学生年级是1</span></span><br><span class="line">teacher1:showRank() <span class="comment">--老师的教资是高级</span></span><br></pre></td></tr></table></figure></div>

    </div>

    
    
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>
        <div class="reward-container">
  <div></div>
  <button onclick="document.getElementById('post-reward').classList.toggle('active');">
    赞赏
  </button>
  <div id="post-reward">
      
      <div>
        <img src="/images/img/wechat.JPG" alt="YOOZIKI 微信">
        <p>微信</p>
      </div>
      
      <div>
        <img src="/images/img/ali.JPG" alt="YOOZIKI 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>YOOZIKI
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://yooziki.github.io/2021/04/042615/" title="Lua编程">https://yooziki.github.io/2021/04/042615/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/images/img/QQ.JPG">
            <span class="icon">
              <i class="fab fa-qq"></i>
            </span>

            <span class="label">TencentQQ</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="https://space.bilibili.com/37478964">
            <span class="icon">
              <i class="fas fa-tv"></i>
            </span>

            <span class="label">Bilibili</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Lua%E5%85%A5%E9%97%A8/" rel="tag"><i class="fa fa-tag"></i> Lua入门</a>
              <a href="/tags/Lua/" rel="tag"><i class="fa fa-tag"></i> Lua</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/04/0313789/" rel="prev" title="Json入门">
      <i class="fa fa-chevron-left"></i> Json入门
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/04/0743832/" rel="next" title="AssetBundle打包">
      AssetBundle打包 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  
    
    
    
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束 <i class="fas fa-grin-squint"></i> 感谢阅读-------------</div> 
    



        </div>
        
      <div class="tabs tabs-comment">
        <ul class="nav-tabs">
            <li class="tab"><a href="#comment-livere">livere</a></li>
            <li class="tab"><a href="#comment-valine">valine</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane livere" id="comment-livere">
              
  <div class="comments">
    <div id="lv-container" data-id="city" data-uid="MTAyMC81MDgzOC8yNzMyMA=="></div>
  </div>
  
            </div>
            <div class="tab-pane valine" id="comment-valine">
              <div class="comments" id="valine-comments"></div>
            </div>
        </div>
      </div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">黔ICP备20006695号-1 </a>
      <img src="/images/%E5%A4%87%E6%A1%88%E5%9B%BE%E6%A0%87.png" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=%E5%8A%9E%E7%90%86%E4%B8%AD" rel="noopener" target="_blank">办理中 </a>
  </div>

<div class="copyright">
  
  &copy; 2020 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">YOOZIKI</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">525k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">7:57</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script defer src="//cdn.jsdelivr.net/npm/three@0/build/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>
    <script defer src="/lib/three/canvas_lines.min.js"></script>
    <script defer src="/lib/three/canvas_sphere.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/next-theme/pjax@0/pjax.min.js"></script>
  <script src="//unpkg.com/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.main-inner',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

document.addEventListener('pjax:success', () => {
  pjax.executeScripts(document.querySelectorAll('script[data-pjax], #pjax script'));
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  const hasTOC = document.querySelector('.post-toc');
  document.querySelector('.sidebar-inner').classList.toggle('sidebar-nav-active', hasTOC);
  if (hasTOC) {
    document.querySelector('.sidebar-nav-toc').click();
  } else {
    document.querySelector('.sidebar-nav-overview').click();
  }
  NexT.utils.updateSidebarPosition();
});
</script>


  
  <script data-pjax>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  
<script src="/js/local-search.js"></script>











<script data-pjax>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.bootcdn.net/ajax/libs/mermaid/8.8.3/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


    <div id="pjax">
  

  
      
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css">


  

<script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js', () => {
    new Valine(Object.assign({
      el  : '#valine-comments',
      path: location.pathname,
    }, {"enable":true,"appId":"iwWiIh3qvC5X9YFhM1WEhrnn-gzGzoHsz","appKey":"Y4yLbOUBKc8XlAlnVnlQ53u9","placeholder":"留言请遵守法律法规，对于违规评论本人将向有关部门举报！邮箱作为收到回复时的通知，不会被公开。","avatar":"mm","meta":["nick","mail"],"pageSize":10,"language":"zh-cn","visitor":true,"comment_count":true,"recordIP":true,"serverURLs":null}
    ));
  }, window.Valine);
});
</script>


  <script async src="/js/cursor/love.min.js"></script>




  <script src="/js/activate-power-mode.min.js"></script>
  <script>
    POWERMODE.colorful = true;
    POWERMODE.shake = false;
    document.body.addEventListener('input', POWERMODE);
  </script>


    </div>
  <!-- 背景特效 -->
  <script type="text/javascript" src="\js\stardust.js"></script>

  <!--浏览器搞笑标题-->
  <script type="text/javascript" src="\js\FunnyTitle.js"></script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"left","width":300,"height":600},"mobile":{"show":false},"log":false});</script></body>
</html>
